<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class 59: Alternating Series and Ratio Test | AP Calculus BC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../shared/styles.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --theme-color: #4f46e5;
            --theme-color-light: #6366f1;
        }

        /* Theorem/Definition Box */
        .theorem-box {
            background: var(--bg-secondary);
            border-left: 4px solid #fbbf24;
            padding: 1.5rem 2rem;
            border-radius: 0 12px 12px 0;
            margin: 1.5rem auto;
            max-width: 800px;
        }

        .theorem-box h3 {
            color: #fbbf24;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .theorem-box .conditions {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .theorem-box .conditions li {
            font-size: 1.5rem;
            margin: 0.75rem 0;
        }

        .theorem-box .conclusion {
            font-size: 1.5rem;
            margin-top: 1.25rem;
            color: var(--success);
        }

        .theorem-box .result-row {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
            font-size: 1.4rem;
        }

        .theorem-box .result-row .condition {
            min-width: 150px;
            font-family: var(--font-mono);
        }

        .theorem-box .result-row .outcome {
            margin-left: 1rem;
        }

        .theorem-box .result-row .outcome.converge {
            color: var(--success);
        }

        .theorem-box .result-row .outcome.diverge {
            color: var(--danger);
        }

        .theorem-box .result-row .outcome.inconclusive {
            color: #fbbf24;
        }

        /* Warning/Note Box */
        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--danger);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 1.25rem;
            color: var(--danger);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Example slide styling */
        .example-box {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem auto;
            max-width: 850px;
            text-align: left;
        }

        .example-box .series {
            font-size: 1.75rem;
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--theme-color);
        }

        .example-box .step {
            font-size: 1.35rem;
            margin: 1rem 0;
            padding-left: 1rem;
        }

        .example-box .step .check {
            color: var(--success);
        }

        .example-box .step .fail {
            color: var(--danger);
        }

        .example-box .conclusion {
            font-size: 1.5rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--bg-tertiary);
            text-align: center;
        }

        .example-box .note {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            font-style: italic;
        }

        /* Summary Table */
        .summary-table {
            width: 100%;
            max-width: 850px;
            margin: 1.5rem auto;
            border-collapse: collapse;
            font-size: 1.25rem;
        }

        .summary-table th,
        .summary-table td {
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .summary-table th {
            background: var(--bg-secondary);
            font-family: var(--font-display);
            font-weight: 600;
            color: var(--theme-color);
        }

        .summary-table td {
            background: var(--bg-primary);
        }

        /* Visualization containers */
        .visualization {
            width: 100%;
            max-width: 800px;
            margin: 1rem auto;
            min-height: 350px;
        }

        /* Slider control */
        .slider-control {
            display: flex;
            align-items: center;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .slider-control label {
            font-size: 1.25rem;
            font-family: var(--font-display);
        }

        .slider-control input[type="range"] {
            width: 250px;
            height: 8px;
            -webkit-appearance: none;
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .slider-control input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--theme-color);
            border-radius: 50%;
            cursor: pointer;
        }

        .slider-control select {
            font-size: 1.25rem;
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .value-display {
            font-family: var(--font-mono);
            font-size: 1.25rem;
            color: var(--accent-secondary);
            min-width: 100px;
        }

        /* BC Badge */
        .bc-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--theme-color), var(--theme-color-light));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 0.5rem;
            vertical-align: middle;
        }

        /* Practice problems */
        .practice-problems {
            text-align: left;
            max-width: 800px;
            margin: 1.5rem auto;
        }

        .practice-problems ol {
            list-style-position: inside;
            font-size: 1.4rem;
        }

        .practice-problems li {
            margin: 1.25rem 0;
            padding-left: 0.5rem;
        }

        .time-badge {
            display: inline-block;
            background: var(--theme-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 1.25rem;
            margin-top: 1.5rem;
        }

        /* Solutions list */
        .solutions-list {
            text-align: left;
            max-width: 850px;
            margin: 1rem auto;
        }

        .solutions-list ol {
            list-style-position: inside;
            font-size: 1.3rem;
        }

        .solutions-list li {
            margin: 1.5rem 0;
            padding-left: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="presentation">
        <!-- Slide 0: Title -->
        <div class="slide slide-title" data-slide="0" data-section="Opening" data-title="Alternating Series and Ratio Test">
            <div class="slide-content">
                <div class="unit-badge">Unit 10: Infinite Sequences and Series</div>
                <h1>Alternating Series and the Ratio Test <span class="bc-badge">BC Only</span></h1>
                <p class="subtitle">Two More Powerful Tools</p>
                <p class="meta">Class 59 | CED 10.7, 10.8 | NCSSM</p>
            </div>
        </div>

        <!-- Slide 1: Opening Hook -->
        <div class="slide slide-statement" data-slide="1" data-section="Opening" data-title="Opening Hook">
            <div class="slide-content">
                <p class="statement">$$1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \frac{1}{5} - \cdots$$</p>
                <p class="secondary" style="margin-top: 2rem; font-size: 1.75rem;">Does this converge?</p>
            </div>
        </div>

        <!-- Slide 2: The Surprise -->
        <div class="slide slide-statement" data-slide="2" data-section="Opening" data-title="The Surprise">
            <div class="slide-content">
                <p class="statement" style="font-size: 2rem;">We know \(1 + \frac{1}{2} + \frac{1}{3} + \frac{1}{4} + \cdots\) <span style="color: var(--danger);">DIVERGES</span></p>
                <p class="secondary" style="margin-top: 2rem; font-size: 1.75rem;">But the alternating version <span style="color: var(--success);">CONVERGES</span> to \(\ln 2\)!</p>
                <p class="caption" style="margin-top: 2rem; font-size: 1.5rem; color: var(--theme-color);">Why does alternating help?</p>
            </div>
        </div>

        <!-- Slide 3: Alternating Series Definition -->
        <div class="slide slide-two-part" data-slide="3" data-section="Alternating Series Test" data-title="Definition">
            <div class="slide-content">
                <p class="primary">An <strong>alternating series</strong> has terms that alternate in sign</p>
                <p style="font-size: 2rem; margin: 1.5rem 0;">$$\sum_{n=1}^{\infty} (-1)^n b_n \quad \text{or} \quad \sum_{n=1}^{\infty} (-1)^{n+1} b_n$$</p>
                <p class="secondary">where \(b_n > 0\) for all \(n\)</p>
                <p class="caption" style="margin-top: 1.5rem;">Pattern: positive, negative, positive, negative, ...</p>
            </div>
        </div>

        <!-- Slide 4: The Alternating Series Test -->
        <div class="slide slide-visual" data-slide="4" data-section="Alternating Series Test" data-title="AST Theorem">
            <div class="slide-content">
                <h2>The Alternating Series Test (AST)</h2>
                <div class="theorem-box">
                    <h3>Theorem</h3>
                    <p style="font-size: 1.4rem;">If:</p>
                    <ol class="conditions">
                        <li>\(b_{n+1} \leq b_n\) for all \(n\) <em>(decreasing)</em></li>
                        <li>\(\displaystyle\lim_{n \to \infty} b_n = 0\)</li>
                    </ol>
                    <p class="conclusion">Then \(\sum (-1)^n b_n\) <strong>converges</strong></p>
                </div>
                <div class="warning-box">
                    <strong>Both conditions required!</strong>
                </div>
            </div>
        </div>

        <!-- Slide 5: Visual Justification -->
        <div class="slide slide-visual" data-slide="5" data-section="Alternating Series Test" data-title="Why It Works">
            <div class="slide-content">
                <h2>Why Alternating Series Converge</h2>
                <div id="oscillation-viz" class="visualization"></div>
                <p class="caption">Partial sums oscillate with decreasing amplitude, converging to S</p>
            </div>
        </div>

        <!-- Slide 6: Oscillating Partial Sums Explorer -->
        <div class="slide slide-visual" data-slide="6" data-section="Alternating Series Test" data-title="Partial Sums Explorer">
            <div class="slide-content">
                <h2>Interactive: Oscillating Partial Sums</h2>
                <div id="partial-sums-viz" class="visualization"></div>
                <div class="slider-control">
                    <label>Terms:</label>
                    <input type="range" id="terms-slider" min="2" max="30" step="1" value="10">
                    <span class="value-display" id="terms-display">n = 10</span>
                </div>
                <p class="caption">The alternating harmonic series converges to ln(2) ≈ 0.693</p>
            </div>
        </div>

        <!-- Slide 7: Example 1 -->
        <div class="slide slide-example" data-slide="7" data-section="Alternating Series Test" data-title="Example 1">
            <div class="slide-content">
                <h2>Example 1: Alternating Harmonic Series</h2>
                <div class="example-box">
                    <div class="series">$$\sum_{n=1}^{\infty} \frac{(-1)^{n+1}}{n} = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \cdots$$</div>
                    <div class="step"><span class="check">✓</span> \(b_n = 1/n > 0\)</div>
                    <div class="step"><span class="check">✓</span> Decreasing: \(\frac{1}{n+1} < \frac{1}{n}\)</div>
                    <div class="step"><span class="check">✓</span> \(\displaystyle\lim_{n \to \infty} \frac{1}{n} = 0\)</div>
                    <div class="conclusion">By AST, <strong style="color: var(--success);">converges</strong> (to \(\ln 2 \approx 0.693\))</div>
                </div>
            </div>
        </div>

        <!-- Slide 8: Example 2 -->
        <div class="slide slide-example" data-slide="8" data-section="Alternating Series Test" data-title="Example 2">
            <div class="slide-content">
                <h2>Example 2</h2>
                <div class="example-box">
                    <div class="series">$$\sum_{n=1}^{\infty} (-1)^n \cdot \frac{n}{n^2+1}$$</div>
                    <div class="step">\(b_n = \frac{n}{n^2+1}\)</div>
                    <div class="step"><span class="check">✓</span> Decreasing? \(b'(x) = \frac{(x^2+1) - x(2x)}{(x^2+1)^2} = \frac{1-x^2}{(x^2+1)^2} < 0\) for \(x > 1\)</div>
                    <div class="step"><span class="check">✓</span> \(\displaystyle\lim_{n \to \infty} \frac{n}{n^2+1} = 0\)</div>
                    <div class="conclusion"><strong style="color: var(--success);">Converges</strong> by AST</div>
                </div>
            </div>
        </div>

        <!-- Slide 9: Example 3 - Test Fails -->
        <div class="slide slide-example" data-slide="9" data-section="Alternating Series Test" data-title="Example 3">
            <div class="slide-content">
                <h2>Example 3: When AST Doesn't Apply</h2>
                <div class="example-box">
                    <div class="series">$$\sum_{n=1}^{\infty} (-1)^n \cdot \frac{n}{n+1}$$</div>
                    <div class="step">\(b_n = \frac{n}{n+1}\)</div>
                    <div class="step"><span class="fail">✗</span> \(\displaystyle\lim_{n \to \infty} \frac{n}{n+1} = 1 \neq 0\)</div>
                    <div class="conclusion">AST <strong style="color: var(--danger);">does not apply!</strong></div>
                    <div class="note">Actually diverges by nth term test</div>
                </div>
            </div>
        </div>

        <!-- Slide 10: The Error Bound -->
        <div class="slide slide-visual" data-slide="10" data-section="Alternating Series Test" data-title="Error Bound">
            <div class="slide-content">
                <h2>Alternating Series Error Bound</h2>
                <div class="theorem-box">
                    <h3>Error Bound Theorem</h3>
                    <p style="font-size: 1.5rem;">For an alternating series satisfying AST:</p>
                    <p style="font-size: 2.25rem; text-align: center; margin: 1.5rem 0; color: var(--theme-color);">$$|S - S_n| \leq b_{n+1}$$</p>
                </div>
                <p class="caption" style="font-size: 1.5rem; margin-top: 1.5rem;">The error after \(n\) terms is at most the next term!</p>
            </div>
        </div>

        <!-- Slide 11: Error Bound Example -->
        <div class="slide slide-example" data-slide="11" data-section="Alternating Series Test" data-title="Error Bound Example">
            <div class="slide-content">
                <h2>Error Bound Application</h2>
                <div class="example-box">
                    <div class="series">Approximate \(\ln 2 = \sum \frac{(-1)^{n+1}}{n}\) with error \(< 0.01\)</div>
                    <div class="step">Need \(b_{n+1} = \frac{1}{n+1} < 0.01\)</div>
                    <div class="step">So \(n+1 > 100\), meaning \(n \geq 100\)</div>
                    <div class="conclusion">Use \(S_{100}\) for accuracy within 0.01</div>
                </div>
            </div>
        </div>

        <!-- Slide 12: Transition to Ratio Test -->
        <div class="slide slide-statement" data-slide="12" data-section="Ratio Test" data-title="Transition">
            <div class="slide-content">
                <p class="statement">What about series with factorials?</p>
                <p style="font-size: 1.75rem; margin: 1.5rem 0;">$$\sum \frac{n!}{3^n} \quad \text{or} \quad \sum \frac{3^n}{n!}$$</p>
                <p class="secondary">Comparison tests are awkward with factorials. We need a new tool.</p>
            </div>
        </div>

        <!-- Slide 13: The Ratio Test -->
        <div class="slide slide-visual" data-slide="13" data-section="Ratio Test" data-title="Ratio Test Theorem">
            <div class="slide-content">
                <h2>The Ratio Test</h2>
                <div class="theorem-box">
                    <h3>Theorem</h3>
                    <p style="font-size: 1.5rem; margin-bottom: 1rem;">Let \(\displaystyle L = \lim_{n \to \infty} \left|\frac{a_{n+1}}{a_n}\right|\)</p>
                    <div class="result-row">
                        <span class="condition">\(L < 1\):</span>
                        <span class="outcome converge">series <strong>converges absolutely</strong></span>
                    </div>
                    <div class="result-row">
                        <span class="condition">\(L > 1\) or \(L = \infty\):</span>
                        <span class="outcome diverge">series <strong>diverges</strong></span>
                    </div>
                    <div class="result-row">
                        <span class="condition">\(L = 1\):</span>
                        <span class="outcome inconclusive">test is <strong>INCONCLUSIVE</strong></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 14: Ratio Test Intuition -->
        <div class="slide slide-statement" data-slide="14" data-section="Ratio Test" data-title="Intuition">
            <div class="slide-content">
                <p class="statement" style="font-size: 1.9rem;">If consecutive term ratios approach \(r\), the series eventually behaves like a geometric series with ratio \(r\)</p>
                <p class="secondary" style="margin-top: 2rem;">Geometric series converge when \(|r| < 1\)</p>
                <p class="caption" style="margin-top: 1.5rem;">The ratio test compares to geometric behavior</p>
            </div>
        </div>

        <!-- Slide 15: Ratio Test Visual -->
        <div class="slide slide-visual" data-slide="15" data-section="Ratio Test" data-title="Ratio Visualization">
            <div class="slide-content">
                <h2>Visualizing the Ratio Test</h2>
                <div id="ratio-viz" class="visualization"></div>
                <div class="slider-control">
                    <label>Series:</label>
                    <select id="series-select">
                        <option value="factorial-over-exp">n!/3^n (L = ∞, diverges)</option>
                        <option value="exp-over-factorial">3^n/n! (L = 0, converges)</option>
                        <option value="p-series">1/n² (L = 1, inconclusive)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Slide 16: When to Use Ratio Test -->
        <div class="slide slide-list" data-slide="16" data-section="Ratio Test" data-title="When to Use">
            <div class="slide-content">
                <h2>Best Applications of Ratio Test</h2>
                <ul>
                    <li>Series with <strong>factorials</strong> (\(n!\))</li>
                    <li>Series with <strong>exponentials</strong> (\(a^n\))</li>
                    <li>Series with <strong>products of both</strong></li>
                </ul>
                <p class="caption" style="margin-top: 2rem;">Ratio test simplifies beautifully when factorials cancel</p>
            </div>
        </div>

        <!-- Slide 17: Ratio Test Example 1 -->
        <div class="slide slide-example" data-slide="17" data-section="Ratio Test" data-title="Ratio Example 1">
            <div class="slide-content">
                <h2>Example 1: Factorial in Numerator</h2>
                <div class="example-box">
                    <div class="series">$$\sum \frac{n!}{3^n}$$</div>
                    <div class="step">\(a_n = n!/3^n\), \(a_{n+1} = (n+1)!/3^{n+1}\)</div>
                    <div class="step">\(\displaystyle\left|\frac{a_{n+1}}{a_n}\right| = \frac{(n+1)!}{3^{n+1}} \cdot \frac{3^n}{n!} = \frac{n+1}{3}\)</div>
                    <div class="step">\(\displaystyle L = \lim_{n \to \infty} \frac{n+1}{3} = \infty\)</div>
                    <div class="conclusion">\(L > 1\) → <strong style="color: var(--danger);">Diverges</strong></div>
                </div>
            </div>
        </div>

        <!-- Slide 18: Ratio Test Example 2 -->
        <div class="slide slide-example" data-slide="18" data-section="Ratio Test" data-title="Ratio Example 2">
            <div class="slide-content">
                <h2>Example 2: Factorial in Denominator</h2>
                <div class="example-box">
                    <div class="series">$$\sum \frac{3^n}{n!}$$</div>
                    <div class="step">\(\displaystyle\left|\frac{a_{n+1}}{a_n}\right| = \frac{3^{n+1}}{(n+1)!} \cdot \frac{n!}{3^n} = \frac{3}{n+1}\)</div>
                    <div class="step">\(\displaystyle L = \lim_{n \to \infty} \frac{3}{n+1} = 0\)</div>
                    <div class="conclusion">\(L < 1\) → <strong style="color: var(--success);">Converges</strong></div>
                    <div class="note">This is related to \(e^3\)</div>
                </div>
            </div>
        </div>

        <!-- Slide 19: Ratio Test Example 3 -->
        <div class="slide slide-example" data-slide="19" data-section="Ratio Test" data-title="Ratio Example 3">
            <div class="slide-content">
                <h2>Example 3: When L = 1 (Inconclusive)</h2>
                <div class="example-box">
                    <div class="series">$$\sum \frac{1}{n^2}$$</div>
                    <div class="step">\(\displaystyle\left|\frac{a_{n+1}}{a_n}\right| = \frac{n^2}{(n+1)^2}\)</div>
                    <div class="step">\(\displaystyle L = \lim_{n \to \infty} \frac{n^2}{(n+1)^2} = 1\)</div>
                    <div class="conclusion">\(L = 1\) → <strong style="color: #fbbf24;">Inconclusive</strong></div>
                    <div class="note">We know this converges by p-series test. Ratio test gives no information.</div>
                </div>
            </div>
        </div>

        <!-- Slide 20: Ratio Test Example 4 -->
        <div class="slide slide-example" data-slide="20" data-section="Ratio Test" data-title="Ratio Example 4">
            <div class="slide-content">
                <h2>Example 4: Alternating with Exponential</h2>
                <div class="example-box">
                    <div class="series">$$\sum \frac{(-1)^n \cdot n^2}{2^n}$$</div>
                    <div class="step">\(\displaystyle\left|\frac{a_{n+1}}{a_n}\right| = \frac{(n+1)^2/2^{n+1}}{n^2/2^n} = \frac{(n+1)^2}{2n^2}\)</div>
                    <div class="step">\(\displaystyle L = \lim_{n \to \infty} \frac{(n+1)^2}{2n^2} = \frac{1}{2}\)</div>
                    <div class="conclusion">\(L < 1\) → <strong style="color: var(--success);">Converges absolutely</strong></div>
                    <div class="note">Absolute value handles the sign</div>
                </div>
            </div>
        </div>

        <!-- Slide 21: L = 1 Warning -->
        <div class="slide slide-statement" data-slide="21" data-section="Ratio Test" data-title="L = 1 Warning">
            <div class="slide-content">
                <p class="statement">\(L = 1\) means the ratio test gives <span style="color: #fbbf24;">NO INFORMATION</span></p>
                <div style="margin: 2rem auto; max-width: 600px; text-align: left;">
                    <p style="font-size: 1.5rem; margin: 1rem 0;">\(\sum 1/n\): \(L = 1\) <span style="color: var(--danger);">(diverges)</span></p>
                    <p style="font-size: 1.5rem; margin: 1rem 0;">\(\sum 1/n^2\): \(L = 1\) <span style="color: var(--success);">(converges)</span></p>
                </div>
                <div class="warning-box">
                    Cannot conclude anything when \(L = 1\) — use another test
                </div>
            </div>
        </div>

        <!-- Slide 22: Test Summary Table -->
        <div class="slide slide-visual" data-slide="22" data-section="Summary" data-title="Test Summary">
            <div class="slide-content">
                <h2>Test Summary</h2>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Test</th>
                            <th>When to Use</th>
                            <th>Conclusion</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>AST</strong></td>
                            <td>\((-1)^n\) factor</td>
                            <td>Both conditions → Converges</td>
                        </tr>
                        <tr>
                            <td><strong>Ratio</strong></td>
                            <td>Factorials, exponentials</td>
                            <td>\(L<1\): converges; \(L>1\): diverges; \(L=1\): inconclusive</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Slide 23: Decision Guidance -->
        <div class="slide slide-list" data-slide="23" data-section="Summary" data-title="Which Test?">
            <div class="slide-content">
                <h2>Which Test to Use?</h2>
                <ul>
                    <li>See \((-1)^n\)? → Try <strong>Alternating Series Test</strong></li>
                    <li>See \(n!\) or \(a^n\)? → Try <strong>Ratio Test</strong></li>
                    <li>Ratio test gives \(L = 1\)? → Use a <strong>different test</strong></li>
                </ul>
                <p class="caption" style="margin-top: 2rem;">When both apply, ratio test often determines absolute convergence</p>
            </div>
        </div>

        <!-- Slide 24: Practice Problem -->
        <div class="slide slide-exercise" data-slide="24" data-section="Practice" data-title="Practice">
            <div class="slide-content">
                <h2>Practice</h2>
                <div class="practice-problems">
                    <ol>
                        <li>Does \(\displaystyle\sum \frac{(-1)^n}{\sqrt{n}}\) converge? Show both AST conditions.</li>
                        <li>Use ratio test: Does \(\displaystyle\sum \frac{2^n \cdot n!}{n^n}\) converge?</li>
                        <li>Why can't we use ratio test for \(\displaystyle\sum 1/n^3\)?</li>
                    </ol>
                </div>
                <div class="time-badge">4 minutes</div>
            </div>
        </div>

        <!-- Slide 25: Practice Solutions -->
        <div class="slide slide-list" data-slide="25" data-section="Practice" data-title="Solutions">
            <div class="slide-content">
                <h2>Solutions</h2>
                <div class="solutions-list">
                    <ol>
                        <li>\(b_n = 1/\sqrt{n}\): decreasing ✓, \(\lim = 0\) ✓. <strong style="color: var(--success);">Converges</strong> by AST</li>
                        <li>\(L = \lim \frac{2^{n+1}(n+1)!/(n+1)^{n+1}}{2^n n!/n^n} = \lim \frac{2(n+1) \cdot n^n}{(n+1)^{n+1}} = 2/e < 1\). <strong style="color: var(--success);">Converges</strong></li>
                        <li>Ratio \(= n^3/(n+1)^3 \to 1\). Inconclusive—use p-series test instead</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Slide 26: Key Takeaways -->
        <div class="slide slide-list" data-slide="26" data-section="Summary" data-title="Key Takeaways">
            <div class="slide-content">
                <h2>Key Takeaways</h2>
                <ul>
                    <li>AST: Check <strong>BOTH</strong> conditions (decreasing AND limit = 0)</li>
                    <li>AST error bound: \(|S - S_n| \leq b_{n+1}\)</li>
                    <li>Ratio test: \(L < 1\) converges, \(L > 1\) diverges, \(L = 1\) inconclusive</li>
                    <li>Ratio test loves factorials—they cancel beautifully</li>
                    <li>\(L = 1\) is a warning—need another test</li>
                </ul>
            </div>
        </div>

        <!-- Slide 27: Exit Ticket -->
        <div class="slide slide-exercise" data-slide="27" data-section="Closing" data-title="Exit Ticket">
            <div class="slide-content">
                <h2>Exit Ticket</h2>
                <div class="practice-problems">
                    <ol>
                        <li>State the two conditions for the Alternating Series Test.</li>
                        <li>For \(\displaystyle\sum (-1)^n/n^2\), verify AST applies. Does it converge?</li>
                        <li>Compute \(L\) for \(\displaystyle\sum n!/2^n\). Does it converge or diverge?</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Slide 28: Coming Up -->
        <div class="slide slide-statement" data-slide="28" data-section="Closing" data-title="Coming Up">
            <div class="slide-content">
                <p class="statement">Next: Absolute vs Conditional Convergence</p>
                <p class="secondary" style="margin-top: 2rem;">Understanding the difference between "strong" and "weak" convergence</p>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>

        <!-- Slide Counter -->
        <div class="slide-counter">1 / 29</div>

        <!-- Keyboard Hint -->
        <div class="keyboard-hint">
            <kbd>←</kbd> <kbd>→</kbd> Navigate | <kbd>T</kbd> TOC | <kbd>S</kbd> Syllabus | <kbd>F</kbd> Fullscreen
        </div>

        <!-- Overlay Backdrop -->
        <div id="overlay-backdrop" class="overlay-backdrop"></div>

        <!-- TOC Overlay -->
        <div id="toc-overlay" class="toc-overlay">
            <button id="toc-close" class="toc-close">&times;</button>
            <div class="toc-header">
                <h3>Table of Contents</h3>
                <div class="class-info">Class 59: Alternating Series and Ratio Test</div>
            </div>
            <div id="toc-content" class="toc-content"></div>
            <div class="toc-footer">
                <a href="../index.html">← Back to Course Syllabus</a>
            </div>
        </div>

        <!-- Appendix Overlay -->
        <div id="appendix-overlay" class="appendix-overlay">
            <div class="appendix-header">
                <h3>Appendix</h3>
                <button id="appendix-close" class="appendix-close">&times;</button>
            </div>
            <div id="appendix-content" class="appendix-content"></div>
            <div class="appendix-nav">
                <button id="appendix-prev" class="appendix-nav-btn">← Prev</button>
                <span id="appendix-counter" class="appendix-counter">1 / 1</span>
                <button id="appendix-next" class="appendix-nav-btn">Next →</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="../shared/presentation.js"></script>
    <script>
        // ===== Oscillation Visualization (Slide 5) =====
        function drawOscillationViz() {
            const container = document.getElementById('oscillation-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 750;
            const height = 350;
            const margin = { top: 40, right: 50, bottom: 50, left: 60 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // Data: alternating harmonic partial sums
            const S = Math.log(2);
            const partialSums = [];
            let sum = 0;
            for (let n = 1; n <= 12; n++) {
                sum += Math.pow(-1, n + 1) / n;
                partialSums.push({ n, sum });
            }

            // Scales
            const xScale = d3.scaleLinear().domain([0, 13]).range([0, plotWidth]);
            const yScale = d3.scaleLinear().domain([0.4, 1.1]).range([plotHeight, 0]);

            // Grid lines
            g.selectAll('line.h-grid')
                .data([0.5, 0.6, 0.7, 0.8, 0.9, 1.0])
                .enter()
                .append('line')
                .attr('x1', 0)
                .attr('x2', plotWidth)
                .attr('y1', d => yScale(d))
                .attr('y2', d => yScale(d))
                .attr('stroke', '#1c2640')
                .attr('stroke-width', 1);

            // Axes
            g.append('g')
                .attr('transform', `translate(0,${plotHeight})`)
                .call(d3.axisBottom(xScale).ticks(13).tickFormat(d => d === 0 ? '' : d))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            g.append('g')
                .call(d3.axisLeft(yScale).ticks(7))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            // Axis labels
            svg.append('text')
                .attr('x', width / 2)
                .attr('y', height - 5)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6')
                .text('n');

            svg.append('text')
                .attr('x', 15)
                .attr('y', height / 2)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6')
                .attr('transform', `rotate(-90, 15, ${height/2})`)
                .text('Sₙ');

            // Limit line
            g.append('line')
                .attr('x1', 0)
                .attr('x2', plotWidth)
                .attr('y1', yScale(S))
                .attr('y2', yScale(S))
                .attr('stroke', '#fbbf24')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '8,4');

            g.append('text')
                .attr('x', plotWidth + 5)
                .attr('y', yScale(S) + 5)
                .attr('font-size', '1.25rem')
                .attr('fill', '#fbbf24')
                .text('S = ln(2)');

            // Line connecting points
            const line = d3.line()
                .x(d => xScale(d.n))
                .y(d => yScale(d.sum));

            g.append('path')
                .datum(partialSums)
                .attr('fill', 'none')
                .attr('stroke', '#4f46e5')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '4,4')
                .attr('d', line);

            // Points with animation
            partialSums.forEach((d, i) => {
                const color = d.sum > S ? '#22c55e' : '#f97316';
                g.append('circle')
                    .attr('cx', xScale(d.n))
                    .attr('cy', yScale(d.sum))
                    .attr('r', 0)
                    .attr('fill', color)
                    .transition()
                    .delay(i * 150)
                    .duration(300)
                    .attr('r', 8);

                // Labels for first few points
                if (i < 5) {
                    g.append('text')
                        .attr('x', xScale(d.n))
                        .attr('y', yScale(d.sum) + (d.sum > S ? -15 : 20))
                        .attr('text-anchor', 'middle')
                        .attr('font-size', '1rem')
                        .attr('fill', '#b8c4d6')
                        .attr('opacity', 0)
                        .text(`S${d.n}`)
                        .transition()
                        .delay(i * 150 + 200)
                        .duration(200)
                        .attr('opacity', 1);
                }
            });

            // Arrows showing oscillation
            g.append('text')
                .attr('x', xScale(2))
                .attr('y', yScale(0.95))
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.5rem')
                .attr('fill', '#22c55e')
                .text('↑');

            g.append('text')
                .attr('x', xScale(3))
                .attr('y', yScale(0.55))
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.5rem')
                .attr('fill', '#f97316')
                .text('↓');
        }

        // ===== Partial Sums Explorer (Slide 6) =====
        function drawPartialSumsViz() {
            const container = document.getElementById('partial-sums-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 750;
            const height = 320;
            const margin = { top: 30, right: 80, bottom: 50, left: 60 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const S = Math.log(2);

            function updatePlot(maxN) {
                g.selectAll('*').remove();

                const partialSums = [];
                let sum = 0;
                for (let n = 1; n <= maxN; n++) {
                    sum += Math.pow(-1, n + 1) / n;
                    partialSums.push({ n, sum });
                }

                // Scales
                const xScale = d3.scaleLinear().domain([0, maxN + 1]).range([0, plotWidth]);
                const yMin = Math.min(0.5, d3.min(partialSums, d => d.sum) - 0.05);
                const yMax = Math.max(1.1, d3.max(partialSums, d => d.sum) + 0.05);
                const yScale = d3.scaleLinear().domain([yMin, yMax]).range([plotHeight, 0]);

                // Axes
                g.append('g')
                    .attr('transform', `translate(0,${plotHeight})`)
                    .call(d3.axisBottom(xScale).ticks(Math.min(maxN, 10)))
                    .selectAll('text')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6');

                g.append('g')
                    .call(d3.axisLeft(yScale).ticks(6))
                    .selectAll('text')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6');

                // Limit line
                g.append('line')
                    .attr('x1', 0)
                    .attr('x2', plotWidth)
                    .attr('y1', yScale(S))
                    .attr('y2', yScale(S))
                    .attr('stroke', '#fbbf24')
                    .attr('stroke-width', 2)
                    .attr('stroke-dasharray', '8,4');

                g.append('text')
                    .attr('x', plotWidth + 5)
                    .attr('y', yScale(S) + 5)
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#fbbf24')
                    .text('ln(2)');

                // Line
                const line = d3.line()
                    .x(d => xScale(d.n))
                    .y(d => yScale(d.sum));

                g.append('path')
                    .datum(partialSums)
                    .attr('fill', 'none')
                    .attr('stroke', '#4f46e5')
                    .attr('stroke-width', 2)
                    .attr('d', line);

                // Points
                g.selectAll('circle')
                    .data(partialSums)
                    .enter()
                    .append('circle')
                    .attr('cx', d => xScale(d.n))
                    .attr('cy', d => yScale(d.sum))
                    .attr('r', maxN > 20 ? 4 : 6)
                    .attr('fill', d => d.sum > S ? '#22c55e' : '#f97316');

                // Current value display
                const lastSum = partialSums[partialSums.length - 1].sum;
                g.append('text')
                    .attr('x', plotWidth / 2)
                    .attr('y', -10)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6')
                    .text(`S${maxN} = ${lastSum.toFixed(6)} | Error = ${Math.abs(S - lastSum).toFixed(6)}`);
            }

            // Initial plot
            updatePlot(10);

            // Slider event
            document.getElementById('terms-slider').addEventListener('input', function(e) {
                const n = parseInt(e.target.value);
                document.getElementById('terms-display').textContent = `n = ${n}`;
                updatePlot(n);
            });
        }

        // ===== Ratio Test Visualization (Slide 15) =====
        function drawRatioViz() {
            const container = document.getElementById('ratio-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 750;
            const height = 350;
            const margin = { top: 50, right: 60, bottom: 50, left: 60 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // Series definitions
            const seriesData = {
                'factorial-over-exp': {
                    name: 'n!/3^n',
                    ratio: n => (n + 1) / 3,
                    limit: Infinity,
                    conclusion: 'DIVERGES'
                },
                'exp-over-factorial': {
                    name: '3^n/n!',
                    ratio: n => 3 / (n + 1),
                    limit: 0,
                    conclusion: 'CONVERGES'
                },
                'p-series': {
                    name: '1/n²',
                    ratio: n => (n * n) / ((n + 1) * (n + 1)),
                    limit: 1,
                    conclusion: 'INCONCLUSIVE'
                }
            };

            function updatePlot(seriesKey) {
                g.selectAll('*').remove();

                const series = seriesData[seriesKey];
                const ratios = [];
                for (let n = 1; n <= 15; n++) {
                    const r = series.ratio(n);
                    if (r < 20) ratios.push({ n, ratio: r });
                }

                // Scales
                const xScale = d3.scaleLinear().domain([0, 16]).range([0, plotWidth]);
                const yMax = Math.min(10, d3.max(ratios, d => d.ratio) * 1.2);
                const yScale = d3.scaleLinear().domain([0, yMax]).range([plotHeight, 0]);

                // Convergence zone (green below y=1)
                g.append('rect')
                    .attr('x', 0)
                    .attr('y', yScale(1))
                    .attr('width', plotWidth)
                    .attr('height', plotHeight - yScale(1))
                    .attr('fill', 'rgba(34, 197, 94, 0.1)');

                // Divergence zone (red above y=1)
                if (yMax > 1) {
                    g.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('width', plotWidth)
                        .attr('height', yScale(1))
                        .attr('fill', 'rgba(239, 68, 68, 0.1)');
                }

                // L = 1 line
                g.append('line')
                    .attr('x1', 0)
                    .attr('x2', plotWidth)
                    .attr('y1', yScale(1))
                    .attr('y2', yScale(1))
                    .attr('stroke', '#fbbf24')
                    .attr('stroke-width', 2)
                    .attr('stroke-dasharray', '8,4');

                g.append('text')
                    .attr('x', plotWidth + 5)
                    .attr('y', yScale(1) + 5)
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#fbbf24')
                    .text('L = 1');

                // Axes
                g.append('g')
                    .attr('transform', `translate(0,${plotHeight})`)
                    .call(d3.axisBottom(xScale).ticks(8))
                    .selectAll('text')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6');

                g.append('g')
                    .call(d3.axisLeft(yScale).ticks(5))
                    .selectAll('text')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6');

                // Axis label
                svg.selectAll('.axis-label').remove();
                svg.append('text')
                    .attr('class', 'axis-label')
                    .attr('x', width / 2)
                    .attr('y', height - 5)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '1.25rem')
                    .attr('fill', '#b8c4d6')
                    .text('n');

                // Line
                const line = d3.line()
                    .x(d => xScale(d.n))
                    .y(d => yScale(d.ratio));

                g.append('path')
                    .datum(ratios)
                    .attr('fill', 'none')
                    .attr('stroke', '#4f46e5')
                    .attr('stroke-width', 2)
                    .attr('d', line);

                // Points
                g.selectAll('circle')
                    .data(ratios)
                    .enter()
                    .append('circle')
                    .attr('cx', d => xScale(d.n))
                    .attr('cy', d => yScale(d.ratio))
                    .attr('r', 6)
                    .attr('fill', '#4f46e5');

                // Limit line if finite
                if (series.limit !== Infinity && series.limit !== 1) {
                    g.append('line')
                        .attr('x1', 0)
                        .attr('x2', plotWidth)
                        .attr('y1', yScale(series.limit))
                        .attr('y2', yScale(series.limit))
                        .attr('stroke', '#22c55e')
                        .attr('stroke-width', 2);
                }

                // Title with conclusion
                let conclusionColor = series.conclusion === 'CONVERGES' ? '#22c55e' :
                                      series.conclusion === 'DIVERGES' ? '#ef4444' : '#fbbf24';

                g.append('text')
                    .attr('x', plotWidth / 2)
                    .attr('y', -20)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '1.5rem')
                    .attr('fill', '#b8c4d6')
                    .html(`|aₙ₊₁/aₙ| for Σ${series.name}`);

                g.append('text')
                    .attr('x', plotWidth / 2)
                    .attr('y', -0)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '1.25rem')
                    .attr('fill', conclusionColor)
                    .text(`L = ${series.limit === Infinity ? '∞' : series.limit} → ${series.conclusion}`);
            }

            // Initial plot
            updatePlot('factorial-over-exp');

            // Select event
            document.getElementById('series-select').addEventListener('change', function(e) {
                updatePlot(e.target.value);
            });
        }

        // ===== Trigger Visualizations on Slide Entry =====
        const visualizationSlides = {
            5: drawOscillationViz,
            6: drawPartialSumsViz,
            15: drawRatioViz
        };

        let lastSlide = -1;

        function checkAndDrawVisualization() {
            if (!window.Presentation) return;

            const currentSlide = window.Presentation.getCurrentSlide();
            if (currentSlide !== lastSlide) {
                lastSlide = currentSlide;
                if (visualizationSlides[currentSlide]) {
                    setTimeout(visualizationSlides[currentSlide], 100);
                }
            }
        }

        // Check periodically for slide changes
        setInterval(checkAndDrawVisualization, 200);

        // Also check on hash changes
        window.addEventListener('hashchange', () => {
            setTimeout(checkAndDrawVisualization, 100);
        });

        // Initial check after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(checkAndDrawVisualization, 200);
            });
        } else {
            setTimeout(checkAndDrawVisualization, 200);
        }
    </script>
</body>
</html>
