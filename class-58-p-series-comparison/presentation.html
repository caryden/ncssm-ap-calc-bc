<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p-Series and Comparison Tests | AP Calculus BC</title>
    <link rel="stylesheet" href="../shared/styles.css">
    <style>
        :root {
            --theme-color: #6366f1;
            --theme-color-light: #818cf8;
            --theme-color-dark: #4f46e5;
            --converge-color: #10b981;
            --diverge-color: #ef4444;
            --compare-color: #f59e0b;
        }

        .unit-badge {
            background: var(--theme-color);
        }

        .bc-badge {
            background: linear-gradient(135deg, var(--theme-color), var(--theme-color-dark));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .slide-title h1 {
            color: var(--theme-color);
        }

        .viz-container {
            width: 100%;
            height: 450px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .viz-container svg {
            max-width: 100%;
            max-height: 100%;
        }

        .definition-box {
            background: linear-gradient(135deg, #f0f0ff 0%, #f8f8ff 100%);
            border-left: 4px solid var(--theme-color);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .definition-box h3 {
            color: var(--theme-color);
            margin: 0 0 0.5rem 0;
        }

        .theorem-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fffbeb 100%);
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .theorem-box h3 {
            color: #d97706;
            margin: 0 0 0.5rem 0;
        }

        .formula-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }

        .converge-box {
            background: #d1fae5;
            border: 2px solid var(--converge-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .diverge-box {
            background: #fee2e2;
            border: 2px solid var(--diverge-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin: 1rem 0;
        }

        .step-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .step-box .step-num {
            display: inline-block;
            width: 28px;
            height: 28px;
            background: var(--theme-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .example-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.1rem;
            margin: 1rem 0;
        }

        .example-table th,
        .example-table td {
            padding: 0.75rem;
            text-align: center;
            border: 1px solid #e5e7eb;
        }

        .example-table th {
            background: var(--theme-color);
            color: white;
        }

        .example-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .controls-container {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .slider-container input[type="range"] {
            width: 200px;
        }

        .slider-value {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--theme-color);
            min-width: 80px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 0.5rem;
            font-size: 1.1rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-color {
            width: 24px;
            height: 4px;
            border-radius: 2px;
        }

        .strategy-card {
            background: white;
            border: 2px solid var(--theme-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .strategy-card h4 {
            color: var(--theme-color);
            margin: 0 0 0.5rem 0;
        }
    </style>
</head>
<body>
    <div class="presentation-container">

        <!-- Slide 0: Title -->
        <section class="slide slide-title">
            <div class="slide-content">
                <span class="unit-badge">Unit 10: Infinite Sequences and Series</span>
                <span class="bc-badge">BC Only</span>
                <h1>p-Series and Comparison Tests</h1>
                <p class="subtitle">Building a Toolkit for Series</p>
                <p class="meta">Class 58 | CED Topics 10.5, 10.6</p>
            </div>
        </section>

        <!-- Slide 1: Warm-Up -->
        <section class="slide slide-exercise">
            <div class="slide-content">
                <h2>Warm-Up</h2>
                <div class="exercise-box">
                    <p>Use the Integral Test to determine convergence:</p>
                    <ol style="font-size: 1.25rem; line-height: 2.5;">
                        <li>\(\sum_{n=1}^{\infty} \frac{1}{n^2}\)</li>
                        <li>\(\sum_{n=1}^{\infty} \frac{1}{\sqrt{n}}\)</li>
                    </ol>
                    <hr style="margin: 1rem 0;">
                    <p><strong>What's the pattern?</strong></p>
                </div>
            </div>
        </section>

        <!-- Slide 2: The p-Series -->
        <section class="slide slide-statement">
            <div class="slide-content">
                <h2>The p-Series</h2>
                <div class="definition-box">
                    <h3>Definition</h3>
                    <p>A <strong>p-series</strong> is a series of the form:</p>
                    <p class="math-display">\[\sum_{n=1}^{\infty} \frac{1}{n^p}\]</p>
                    <p>where \(p\) is a positive constant.</p>
                </div>
                <div style="margin-top: 1.5rem;">
                    <p style="font-size: 1.25rem;"><strong>Examples:</strong></p>
                    <ul style="font-size: 1.2rem; line-height: 2;">
                        <li>\(p = 1\): Harmonic series \(\sum \frac{1}{n}\)</li>
                        <li>\(p = 2\): \(\sum \frac{1}{n^2}\) (Basel problem)</li>
                        <li>\(p = \frac{1}{2}\): \(\sum \frac{1}{\sqrt{n}}\)</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Slide 3: p-Series Test -->
        <section class="slide slide-statement">
            <div class="slide-content">
                <h2>p-Series Test</h2>
                <div class="theorem-box">
                    <h3>Theorem</h3>
                    <p>The p-series \(\sum_{n=1}^{\infty} \frac{1}{n^p}\) converges if \(p > 1\) and diverges if \(p \leq 1\).</p>
                </div>
                <div class="comparison-grid" style="margin-top: 1.5rem;">
                    <div class="converge-box">
                        <p style="text-align: center; font-weight: bold;">Converges when \(p > 1\)</p>
                        <p style="margin-top: 0.5rem; text-align: center;">\(\sum \frac{1}{n^2}\), \(\sum \frac{1}{n^3}\), \(\sum \frac{1}{n^{1.01}}\)</p>
                    </div>
                    <div class="diverge-box">
                        <p style="text-align: center; font-weight: bold;">Diverges when \(p \leq 1\)</p>
                        <p style="margin-top: 0.5rem; text-align: center;">\(\sum \frac{1}{n}\), \(\sum \frac{1}{\sqrt{n}}\), \(\sum \frac{1}{n^{0.99}}\)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 4: p-Series Visualization -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Visualizing p-Series Convergence</h2>
                <div id="pseries-viz" class="viz-container"></div>
                <div class="slider-container">
                    <span>p = </span>
                    <input type="range" id="p-slider" min="25" max="300" value="100">
                    <span class="slider-value" id="p-value">1.00</span>
                </div>
            </div>
        </section>

        <!-- Slide 5: Why p = 1 is the Boundary -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Why p = 1 is the Boundary</h2>
                <div class="formula-box">
                    <p>Using the Integral Test with \(f(x) = \frac{1}{x^p}\):</p>
                    <p style="margin-top: 1rem;">\(\int_1^{\infty} \frac{1}{x^p}\, dx = \begin{cases} \frac{1}{p-1} & \text{if } p > 1 \\ \infty & \text{if } p \leq 1 \end{cases}\)</p>
                </div>
                <div class="step-box" style="margin-top: 1rem;">
                    <p><strong>For \(p \neq 1\):</strong></p>
                    <p>\(\int_1^{\infty} x^{-p}\, dx = \left[\frac{x^{-p+1}}{-p+1}\right]_1^{\infty} = \frac{1}{1-p}\lim_{b \to \infty} (b^{1-p} - 1)\)</p>
                </div>
                <div class="step-box">
                    <p><strong>For \(p = 1\):</strong> \(\int_1^{\infty} \frac{1}{x}\, dx = \ln x \big|_1^{\infty} = \infty\)</p>
                </div>
            </div>
        </section>

        <!-- Slide 6: p-Series Examples -->
        <section class="slide slide-list">
            <div class="slide-content">
                <h2>p-Series Examples</h2>
                <table class="example-table">
                    <tr>
                        <th>Series</th>
                        <th>p value</th>
                        <th>Converges?</th>
                    </tr>
                    <tr>
                        <td>\(\sum \frac{1}{n^2}\)</td>
                        <td>2</td>
                        <td style="color: #10b981;">Yes (\(\frac{\pi^2}{6}\))</td>
                    </tr>
                    <tr>
                        <td>\(\sum \frac{1}{n^{3/2}}\)</td>
                        <td>3/2</td>
                        <td style="color: #10b981;">Yes</td>
                    </tr>
                    <tr>
                        <td>\(\sum \frac{1}{n}\)</td>
                        <td>1</td>
                        <td style="color: #ef4444;">No</td>
                    </tr>
                    <tr>
                        <td>\(\sum \frac{1}{\sqrt[3]{n}}\)</td>
                        <td>1/3</td>
                        <td style="color: #ef4444;">No</td>
                    </tr>
                    <tr>
                        <td>\(\sum \frac{1}{n^{1.001}}\)</td>
                        <td>1.001</td>
                        <td style="color: #10b981;">Yes (barely!)</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- Slide 7: Direct Comparison Test -->
        <section class="slide slide-statement">
            <div class="slide-content">
                <h2>Direct Comparison Test</h2>
                <div class="theorem-box">
                    <h3>Theorem</h3>
                    <p>Suppose \(0 \leq a_n \leq b_n\) for all \(n\) (eventually).</p>
                    <ul style="margin-top: 1rem; line-height: 2;">
                        <li>If \(\sum b_n\) converges, then \(\sum a_n\) converges.</li>
                        <li>If \(\sum a_n\) diverges, then \(\sum b_n\) diverges.</li>
                    </ul>
                </div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p><strong>Intuition:</strong> Smaller than a convergent series? Converges!</p>
                    <p>Larger than a divergent series? Diverges!</p>
                </div>
            </div>
        </section>

        <!-- Slide 8: Comparison Visualization -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Visualizing Comparison</h2>
                <div id="comparison-viz" class="viz-container"></div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--converge-color);"></div>
                        <span>Known convergent series</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--theme-color);"></div>
                        <span>Series being tested (smaller)</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 9: Direct Comparison Strategy -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Direct Comparison Strategy</h2>
                <div class="comparison-grid">
                    <div class="strategy-card">
                        <h4>To prove CONVERGENCE:</h4>
                        <p>Find a <strong>larger</strong> series that converges</p>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;">\(a_n \leq b_n\) and \(\sum b_n\) converges</p>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>Common choices:</em> p-series (\(p > 1\)), geometric</p>
                    </div>
                    <div class="strategy-card">
                        <h4>To prove DIVERGENCE:</h4>
                        <p>Find a <strong>smaller</strong> series that diverges</p>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;">\(a_n \geq b_n\) and \(\sum b_n\) diverges</p>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;"><em>Common choices:</em> harmonic series, p-series (\(p \leq 1\))</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 10: Direct Comparison Example 1 -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Example: Direct Comparison</h2>
                <div class="formula-box">
                    <p>Does \(\sum_{n=1}^{\infty} \frac{1}{n^2 + 1}\) converge?</p>
                </div>
                <div class="step-box" style="margin-top: 1rem;">
                    <p><span class="step-num">1</span><strong>Compare:</strong> \(\frac{1}{n^2 + 1} < \frac{1}{n^2}\) for all \(n \geq 1\)</p>
                </div>
                <div class="step-box">
                    <p><span class="step-num">2</span><strong>Known:</strong> \(\sum \frac{1}{n^2}\) is a p-series with \(p = 2 > 1\), so it converges</p>
                </div>
                <div class="converge-box" style="margin-top: 1rem;">
                    <p><strong>Conclusion:</strong> By Direct Comparison, \(\sum \frac{1}{n^2 + 1}\) converges.</p>
                </div>
            </div>
        </section>

        <!-- Slide 11: Direct Comparison Example 2 -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Example: Direct Comparison</h2>
                <div class="formula-box">
                    <p>Does \(\sum_{n=1}^{\infty} \frac{\ln n}{n}\) converge?</p>
                </div>
                <div class="step-box" style="margin-top: 1rem;">
                    <p><span class="step-num">1</span><strong>Compare:</strong> For \(n \geq 3\): \(\ln n > 1\), so \(\frac{\ln n}{n} > \frac{1}{n}\)</p>
                </div>
                <div class="step-box">
                    <p><span class="step-num">2</span><strong>Known:</strong> \(\sum \frac{1}{n}\) is the harmonic series, which diverges</p>
                </div>
                <div class="diverge-box" style="margin-top: 1rem;">
                    <p><strong>Conclusion:</strong> By Direct Comparison, \(\sum \frac{\ln n}{n}\) diverges.</p>
                </div>
            </div>
        </section>

        <!-- Slide 12: Limit Comparison Test -->
        <section class="slide slide-statement">
            <div class="slide-content">
                <h2>Limit Comparison Test</h2>
                <div class="theorem-box">
                    <h3>Theorem</h3>
                    <p>Let \(a_n > 0\) and \(b_n > 0\) for all \(n\). If</p>
                    <p class="math-display">\[\lim_{n \to \infty} \frac{a_n}{b_n} = L\]</p>
                    <p>where \(0 < L < \infty\), then \(\sum a_n\) and \(\sum b_n\) either both converge or both diverge.</p>
                </div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p><strong>Key insight:</strong> If the limit is a positive finite number, the series have the same behavior!</p>
                </div>
            </div>
        </section>

        <!-- Slide 13: Why Limit Comparison Works -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Why Limit Comparison Works</h2>
                <div class="definition-box">
                    <h3>Intuition</h3>
                    <p>If \(\lim \frac{a_n}{b_n} = L\) where \(0 < L < \infty\):</p>
                    <p style="margin-top: 0.5rem;">Then \(a_n \approx L \cdot b_n\) for large \(n\)</p>
                    <p style="margin-top: 0.5rem;">So \(\sum a_n \approx L \cdot \sum b_n\)</p>
                </div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p><strong>Formal proof idea:</strong></p>
                    <p>Since \(\frac{a_n}{b_n} \to L\), for large \(n\):</p>
                    <p>\(\frac{L}{2} < \frac{a_n}{b_n} < \frac{3L}{2}\)</p>
                    <p>So \(\frac{L}{2}b_n < a_n < \frac{3L}{2}b_n\)</p>
                </div>
            </div>
        </section>

        <!-- Slide 14: Limit Comparison Example 1 -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Example: Limit Comparison</h2>
                <div class="formula-box">
                    <p>Does \(\sum_{n=1}^{\infty} \frac{1}{2n^2 + 3n}\) converge?</p>
                </div>
                <div class="step-box" style="margin-top: 1rem;">
                    <p><span class="step-num">1</span><strong>Choose comparison:</strong> Compare to \(\frac{1}{n^2}\) (dominant term)</p>
                </div>
                <div class="step-box">
                    <p><span class="step-num">2</span><strong>Compute limit:</strong></p>
                    <p style="margin-left: 2.5rem;">\(\lim_{n \to \infty} \frac{1/(2n^2+3n)}{1/n^2} = \lim_{n \to \infty} \frac{n^2}{2n^2+3n} = \lim_{n \to \infty} \frac{1}{2+3/n} = \frac{1}{2}\)</p>
                </div>
                <div class="converge-box" style="margin-top: 1rem;">
                    <p><strong>Conclusion:</strong> Since \(0 < \frac{1}{2} < \infty\) and \(\sum \frac{1}{n^2}\) converges, so does \(\sum \frac{1}{2n^2+3n}\).</p>
                </div>
            </div>
        </section>

        <!-- Slide 15: Limit Comparison Example 2 -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Example: Limit Comparison</h2>
                <div class="formula-box">
                    <p>Does \(\sum_{n=1}^{\infty} \frac{n+1}{\sqrt{n^3 + 2}}\) converge?</p>
                </div>
                <div class="step-box" style="margin-top: 1rem;">
                    <p><span class="step-num">1</span><strong>Choose comparison:</strong> \(\frac{n+1}{\sqrt{n^3+2}} \approx \frac{n}{\sqrt{n^3}} = \frac{n}{n^{3/2}} = \frac{1}{n^{1/2}}\)</p>
                </div>
                <div class="step-box">
                    <p><span class="step-num">2</span><strong>Compute limit:</strong></p>
                    <p style="margin-left: 2.5rem;">\(\lim_{n \to \infty} \frac{(n+1)/\sqrt{n^3+2}}{1/\sqrt{n}} = \lim_{n \to \infty} \frac{(n+1)\sqrt{n}}{\sqrt{n^3+2}} = \lim_{n \to \infty} \frac{n^{3/2} + n^{1/2}}{\sqrt{n^3+2}} = 1\)</p>
                </div>
                <div class="diverge-box" style="margin-top: 1rem;">
                    <p><strong>Conclusion:</strong> Since \(\sum \frac{1}{\sqrt{n}}\) diverges (\(p = \frac{1}{2} \leq 1\)), so does the original series.</p>
                </div>
            </div>
        </section>

        <!-- Slide 16: Comparison Test Visualization -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Limit Comparison Visualization</h2>
                <div id="limit-comparison-viz" class="viz-container"></div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--theme-color);"></div>
                        <span>\(a_n\)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--compare-color);"></div>
                        <span>\(b_n\) (comparison)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--diverge-color);"></div>
                        <span>Ratio \(a_n/b_n\)</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 17: When to Use Which Test -->
        <section class="slide slide-visual">
            <div class="slide-content">
                <h2>Choosing the Right Comparison</h2>
                <div class="comparison-grid">
                    <div class="strategy-card">
                        <h4>Direct Comparison</h4>
                        <ul style="line-height: 1.8; font-size: 0.95rem;">
                            <li>Easy inequality available</li>
                            <li>\(a_n\) clearly smaller/larger</li>
                            <li>Simple form like \(\frac{1}{n^2+1} < \frac{1}{n^2}\)</li>
                        </ul>
                    </div>
                    <div class="strategy-card">
                        <h4>Limit Comparison</h4>
                        <ul style="line-height: 1.8; font-size: 0.95rem;">
                            <li>Complicated expressions</li>
                            <li>Focus on dominant terms</li>
                            <li>When inequality is hard to establish</li>
                        </ul>
                    </div>
                </div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p><strong>Tip:</strong> For \(\sum \frac{p(n)}{q(n)}\) where \(p, q\) are polynomials, compare to \(\frac{1}{n^k}\) where \(k = \deg(q) - \deg(p)\)</p>
                </div>
            </div>
        </section>

        <!-- Slide 18: Practice Problems -->
        <section class="slide slide-exercise">
            <div class="slide-content">
                <h2>Practice Problems</h2>
                <div class="exercise-box">
                    <p><strong>Determine convergence or divergence:</strong></p>
                    <ol style="font-size: 1.15rem; line-height: 2.3;">
                        <li>\(\sum_{n=1}^{\infty} \frac{1}{n^{4/3}}\)</li>
                        <li>\(\sum_{n=1}^{\infty} \frac{n}{n^3 + 1}\)</li>
                        <li>\(\sum_{n=1}^{\infty} \frac{1}{3^n + n}\)</li>
                        <li>\(\sum_{n=2}^{\infty} \frac{1}{\sqrt{n^2 - 1}}\)</li>
                        <li>\(\sum_{n=1}^{\infty} \frac{2 + \sin n}{n^2}\)</li>
                    </ol>
                </div>
            </div>
        </section>

        <!-- Slide 19: Solutions -->
        <section class="slide slide-list">
            <div class="slide-content">
                <h2>Solutions</h2>
                <ol style="font-size: 1.05rem; line-height: 2.1;">
                    <li>p-series with \(p = \frac{4}{3} > 1\): <strong style="color: #10b981;">Converges</strong></li>
                    <li>LCT with \(\frac{1}{n^2}\): \(\lim \frac{n/(n^3+1)}{1/n^2} = \lim \frac{n^3}{n^3+1} = 1\). Since \(\sum \frac{1}{n^2}\) converges: <strong style="color: #10b981;">Converges</strong></li>
                    <li>DCT: \(\frac{1}{3^n + n} < \frac{1}{3^n}\), geometric with \(r = \frac{1}{3}\): <strong style="color: #10b981;">Converges</strong></li>
                    <li>LCT with \(\frac{1}{n}\): \(\lim \frac{1/\sqrt{n^2-1}}{1/n} = \lim \frac{n}{\sqrt{n^2-1}} = 1\). Harmonic diverges: <strong style="color: #ef4444;">Diverges</strong></li>
                    <li>DCT: \(\frac{2+\sin n}{n^2} \leq \frac{3}{n^2}\), and \(\sum \frac{3}{n^2}\) converges: <strong style="color: #10b981;">Converges</strong></li>
                </ol>
            </div>
        </section>

        <!-- Slide 20: Looking Ahead -->
        <section class="slide slide-title">
            <div class="slide-content">
                <h2>Looking Ahead</h2>
                <div style="margin-top: 2rem;">
                    <h3 style="color: var(--theme-color);">Next: Alternating Series and Ratio Test</h3>
                    <ul style="font-size: 1.35rem; line-height: 2; list-style: none; padding: 0; margin-top: 1.5rem;">
                        <li>Alternating Series Test</li>
                        <li>Ratio Test for series with factorials</li>
                        <li>Root Test</li>
                    </ul>
                </div>
            </div>
        </section>

    </div>

    <!-- Navigation -->
    <nav class="slide-nav">
        <button id="prevBtn" aria-label="Previous slide">&#8592;</button>
        <span id="slideCounter">1 / 21</span>
        <button id="nextBtn" aria-label="Next slide">&#8594;</button>
        <button id="tocBtn" aria-label="Table of contents">&#9776;</button>
    </nav>

    <!-- Table of Contents -->
    <div id="toc" class="toc-overlay">
        <div class="toc-content">
            <h3>Contents</h3>
            <ul id="tocList"></ul>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script>
    <script src="../shared/presentation.js"></script>

    <script>
        // Visualization management
        const visualizationSlides = {
            4: drawPSeriesViz,
            8: drawComparisonViz,
            16: drawLimitComparisonViz
        };

        let lastSlide = -1;

        function checkAndDrawVisualization() {
            if (!window.Presentation) return;
            const currentSlide = window.Presentation.getCurrentSlide();
            if (currentSlide !== lastSlide) {
                lastSlide = currentSlide;
                if (visualizationSlides[currentSlide]) {
                    setTimeout(visualizationSlides[currentSlide], 100);
                }
            }
        }

        setInterval(checkAndDrawVisualization, 200);

        // p-Series Visualization
        function drawPSeriesViz() {
            const container = d3.select('#pseries-viz');
            container.selectAll('*').remove();

            const width = 700;
            const height = 380;
            const margin = { top: 40, right: 80, bottom: 50, left: 60 };

            const svg = container.append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const slider = document.getElementById('p-slider');
            const valueDisplay = document.getElementById('p-value');

            function update() {
                svg.selectAll('*').remove();

                const p = parseInt(slider.value) / 100;
                valueDisplay.textContent = p.toFixed(2);
                valueDisplay.style.color = p > 1 ? '#10b981' : '#ef4444';

                const nMax = 30;
                const nValues = d3.range(1, nMax + 1);

                let sum = 0;
                const data = nValues.map(n => {
                    sum += 1 / Math.pow(n, p);
                    return { n, term: 1 / Math.pow(n, p), sum };
                });

                const maxSum = p > 1 ? Math.min(data[data.length - 1].sum * 1.2, 10) : data[data.length - 1].sum * 1.1;

                const xScale = d3.scaleLinear()
                    .domain([0, nMax + 1])
                    .range([margin.left, width - margin.right]);

                const yScale = d3.scaleLinear()
                    .domain([0, maxSum])
                    .range([height - margin.bottom, margin.top]);

                // Grid
                svg.append('g')
                    .selectAll('line')
                    .data(yScale.ticks(5))
                    .enter().append('line')
                    .attr('x1', margin.left)
                    .attr('x2', width - margin.right)
                    .attr('y1', d => yScale(d))
                    .attr('y2', d => yScale(d))
                    .attr('stroke', '#e5e7eb')
                    .attr('stroke-width', 1);

                // Axes
                svg.append('line')
                    .attr('x1', margin.left)
                    .attr('x2', width - margin.right)
                    .attr('y1', yScale(0))
                    .attr('y2', yScale(0))
                    .attr('stroke', '#333')
                    .attr('stroke-width', 2);

                svg.append('line')
                    .attr('x1', margin.left)
                    .attr('x2', margin.left)
                    .attr('y1', margin.top)
                    .attr('y2', height - margin.bottom)
                    .attr('stroke', '#333')
                    .attr('stroke-width', 2);

                // Partial sums
                const line = d3.line()
                    .x(d => xScale(d.n))
                    .y(d => yScale(d.sum));

                svg.append('path')
                    .datum(data)
                    .attr('fill', 'none')
                    .attr('stroke', p > 1 ? '#10b981' : '#ef4444')
                    .attr('stroke-width', 3)
                    .attr('d', line);

                // Points
                svg.selectAll('.point')
                    .data(data)
                    .enter().append('circle')
                    .attr('cx', d => xScale(d.n))
                    .attr('cy', d => yScale(d.sum))
                    .attr('r', 3)
                    .attr('fill', p > 1 ? '#10b981' : '#ef4444');

                // Status
                svg.append('text')
                    .attr('x', width / 2)
                    .attr('y', margin.top - 10)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '1.2rem')
                    .attr('font-weight', 'bold')
                    .attr('fill', p > 1 ? '#10b981' : '#ef4444')
                    .text(p > 1 ? 'CONVERGES (p > 1)' : 'DIVERGES (p <= 1)');

                // Current sum
                svg.append('text')
                    .attr('x', width - margin.right + 5)
                    .attr('y', yScale(data[data.length - 1].sum))
                    .attr('dy', '0.35em')
                    .attr('font-size', '0.9rem')
                    .text(`S${nMax} = ${data[data.length - 1].sum.toFixed(2)}`);
            }

            slider.oninput = update;
            update();
        }

        // Direct Comparison Visualization
        function drawComparisonViz() {
            const container = d3.select('#comparison-viz');
            container.selectAll('*').remove();

            const width = 700;
            const height = 380;
            const margin = { top: 30, right: 30, bottom: 50, left: 60 };

            const svg = container.append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const nMax = 15;
            const nValues = d3.range(1, nMax + 1);

            // 1/(n^2+1) compared to 1/n^2
            const dataSmaller = nValues.map(n => ({ n, value: 1 / (n * n + 1) }));
            const dataLarger = nValues.map(n => ({ n, value: 1 / (n * n) }));

            const xScale = d3.scaleLinear()
                .domain([0, nMax + 1])
                .range([margin.left, width - margin.right]);

            const yScale = d3.scaleLinear()
                .domain([0, 1.2])
                .range([height - margin.bottom, margin.top]);

            // Grid
            svg.append('g')
                .selectAll('line')
                .data([0, 0.25, 0.5, 0.75, 1])
                .enter().append('line')
                .attr('x1', margin.left)
                .attr('x2', width - margin.right)
                .attr('y1', d => yScale(d))
                .attr('y2', d => yScale(d))
                .attr('stroke', '#e5e7eb')
                .attr('stroke-width', 1);

            // Axes
            svg.append('line')
                .attr('x1', margin.left)
                .attr('x2', width - margin.right)
                .attr('y1', yScale(0))
                .attr('y2', yScale(0))
                .attr('stroke', '#333')
                .attr('stroke-width', 2);

            // Bars for larger series (1/n^2)
            const barWidth = (width - margin.left - margin.right) / (nMax + 1) * 0.35;

            svg.selectAll('.bar-larger')
                .data(dataLarger)
                .enter().append('rect')
                .attr('x', d => xScale(d.n) - barWidth)
                .attr('y', d => yScale(d.value))
                .attr('width', barWidth)
                .attr('height', d => yScale(0) - yScale(d.value))
                .attr('fill', '#10b981')
                .attr('opacity', 0.7);

            // Bars for smaller series (1/(n^2+1))
            svg.selectAll('.bar-smaller')
                .data(dataSmaller)
                .enter().append('rect')
                .attr('x', d => xScale(d.n))
                .attr('y', d => yScale(d.value))
                .attr('width', barWidth)
                .attr('height', d => yScale(0) - yScale(d.value))
                .attr('fill', '#6366f1')
                .attr('opacity', 0.7);

            // Labels
            svg.append('text')
                .attr('x', width / 2)
                .attr('y', margin.top - 5)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1rem')
                .text('1/(n^2+1) < 1/n^2: smaller than convergent => converges');

            // X-axis labels
            nValues.filter(n => n % 2 === 1).forEach(n => {
                svg.append('text')
                    .attr('x', xScale(n))
                    .attr('y', height - margin.bottom + 20)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '0.9rem')
                    .text(n);
            });
        }

        // Limit Comparison Visualization
        function drawLimitComparisonViz() {
            const container = d3.select('#limit-comparison-viz');
            container.selectAll('*').remove();

            const width = 700;
            const height = 380;
            const margin = { top: 30, right: 30, bottom: 50, left: 60 };

            const svg = container.append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const nMax = 20;
            const nValues = d3.range(1, nMax + 1);

            // a_n = 1/(2n^2 + 3n), b_n = 1/n^2
            const dataA = nValues.map(n => ({ n, value: 1 / (2 * n * n + 3 * n) }));
            const dataB = nValues.map(n => ({ n, value: 1 / (n * n) }));
            const dataRatio = nValues.map(n => ({
                n,
                value: (1 / (2 * n * n + 3 * n)) / (1 / (n * n))
            }));

            const xScale = d3.scaleLinear()
                .domain([0, nMax + 1])
                .range([margin.left, width - margin.right]);

            const yScaleTerms = d3.scaleLinear()
                .domain([0, 0.3])
                .range([height - margin.bottom, margin.top + 100]);

            const yScaleRatio = d3.scaleLinear()
                .domain([0, 1])
                .range([margin.top + 80, margin.top]);

            // Terms section
            svg.append('text')
                .attr('x', margin.left)
                .attr('y', margin.top + 110)
                .attr('font-size', '0.9rem')
                .attr('font-weight', 'bold')
                .text('Terms:');

            // Grid for terms
            svg.append('g')
                .selectAll('line')
                .data([0, 0.1, 0.2, 0.3])
                .enter().append('line')
                .attr('x1', margin.left)
                .attr('x2', width - margin.right)
                .attr('y1', d => yScaleTerms(d))
                .attr('y2', d => yScaleTerms(d))
                .attr('stroke', '#e5e7eb')
                .attr('stroke-width', 1);

            // a_n line
            const lineA = d3.line()
                .x(d => xScale(d.n))
                .y(d => yScaleTerms(d.value));

            svg.append('path')
                .datum(dataA)
                .attr('fill', 'none')
                .attr('stroke', '#6366f1')
                .attr('stroke-width', 2)
                .attr('d', lineA);

            // b_n line
            const lineB = d3.line()
                .x(d => xScale(d.n))
                .y(d => yScaleTerms(d.value));

            svg.append('path')
                .datum(dataB)
                .attr('fill', 'none')
                .attr('stroke', '#f59e0b')
                .attr('stroke-width', 2)
                .attr('d', lineB);

            // Ratio section
            svg.append('text')
                .attr('x', margin.left)
                .attr('y', margin.top + 10)
                .attr('font-size', '0.9rem')
                .attr('font-weight', 'bold')
                .text('Ratio a_n/b_n:');

            // Limit line at 0.5
            svg.append('line')
                .attr('x1', margin.left)
                .attr('x2', width - margin.right)
                .attr('y1', yScaleRatio(0.5))
                .attr('y2', yScaleRatio(0.5))
                .attr('stroke', '#10b981')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '5,5');

            svg.append('text')
                .attr('x', width - margin.right + 5)
                .attr('y', yScaleRatio(0.5))
                .attr('dy', '0.35em')
                .attr('font-size', '1.25rem')
                .attr('fill', '#10b981')
                .text('L = 0.5');

            // Ratio line
            const lineRatio = d3.line()
                .x(d => xScale(d.n))
                .y(d => yScaleRatio(d.value));

            svg.append('path')
                .datum(dataRatio)
                .attr('fill', 'none')
                .attr('stroke', '#ef4444')
                .attr('stroke-width', 2)
                .attr('d', lineRatio);

            // Points on ratio
            svg.selectAll('.ratio-point')
                .data(dataRatio)
                .enter().append('circle')
                .attr('cx', d => xScale(d.n))
                .attr('cy', d => yScaleRatio(d.value))
                .attr('r', 3)
                .attr('fill', '#ef4444');

            // X-axis
            svg.append('line')
                .attr('x1', margin.left)
                .attr('x2', width - margin.right)
                .attr('y1', yScaleTerms(0))
                .attr('y2', yScaleTerms(0))
                .attr('stroke', '#333')
                .attr('stroke-width', 2);
        }
    </script>
</body>
</html>
