<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class 52: Motion in the Plane | AP Calculus BC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../shared/styles.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --theme-color: #0891b2;
            --theme-color-light: #22d3ee;
        }

        /* Custom styles for motion vectors presentation */
        .bc-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--theme-color), #0e7490);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 0.5rem;
            vertical-align: middle;
        }

        .vector-display {
            font-family: var(--font-mono);
            font-size: 1.5rem;
            color: var(--theme-color);
        }

        .formula-box {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            border-radius: 12px;
            border-left: 4px solid var(--theme-color);
            margin: 1rem 0;
        }

        .formula-box.highlight {
            border-left-color: #f97316;
        }

        .key-insight {
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.1), rgba(8, 145, 178, 0.05));
            border: 1px solid var(--theme-color);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .motion-viz-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .viz-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .viz-controls button {
            background: var(--theme-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            font-family: var(--font-display);
        }

        .viz-controls button:hover {
            background: var(--theme-color-light);
        }

        .viz-controls label {
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .viz-controls input[type="range"] {
            width: 150px;
            height: 8px;
            -webkit-appearance: none;
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .viz-controls input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--theme-color);
            border-radius: 50%;
            cursor: pointer;
        }

        .data-display {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
            font-size: 1.25rem;
        }

        .data-item {
            background: var(--bg-secondary);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .data-item .label {
            font-size: 1rem;
            color: var(--text-tertiary);
            margin-bottom: 0.25rem;
        }

        .data-item .value {
            font-family: var(--font-mono);
            color: var(--theme-color);
        }

        .step-solution {
            text-align: left;
            max-width: 700px;
            margin: 0 auto;
        }

        .step-solution .step {
            margin-bottom: 1.5rem;
        }

        .step-solution .step-header {
            font-weight: 600;
            color: var(--theme-color);
            margin-bottom: 0.5rem;
        }

        .comparison-highlight {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .comparison-highlight .item {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }

        .comparison-highlight .item h4 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .comparison-highlight .item.vector {
            border-top: 4px solid #f97316;
        }

        .comparison-highlight .item.scalar {
            border-top: 4px solid #22c55e;
        }

        .speedometer {
            width: 120px;
            height: 60px;
            margin: 0 auto;
            position: relative;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="presentation">
        <!-- Slide 0: Title -->
        <div class="slide slide-title" data-slide="0" data-section="Opening" data-title="Motion in the Plane">
            <div class="slide-content">
                <div class="unit-badge">Unit 9: Parametric, Polar, and Vector-Valued Functions <span class="bc-badge">BC Only</span></div>
                <h1>Motion in the Plane</h1>
                <p class="subtitle">Position, Velocity, and Acceleration Vectors</p>
                <p class="meta">Class 52 | CED 9.6 | NCSSM</p>
            </div>
        </div>

        <!-- Slide 1: The Projectile Question -->
        <div class="slide slide-visual" data-slide="1" data-section="Opening" data-title="The Projectile Question">
            <div class="slide-content">
                <h2>At the Peak of a Projectile's Path...</h2>
                <div id="projectile-question-viz" class="visualization"></div>
                <div style="margin-top: 1.5rem; font-size: 1.5rem;">
                    <p style="color: var(--accent-secondary);">What's the velocity at the highest point?</p>
                    <p style="color: var(--accent-secondary); margin-top: 0.5rem;">What's the acceleration at the highest point?</p>
                </div>
            </div>
        </div>

        <!-- Slide 2: The Answer Revealed -->
        <div class="slide slide-two-part" data-slide="2" data-section="Opening" data-title="The Answer Revealed">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">At the Peak</p>
                <div class="formula-box" style="margin-top: 1.5rem;">
                    <p style="font-size: 1.5rem;">Vertical velocity = 0, but horizontal velocity is NOT zero!</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem; font-family: var(--font-mono);">v = &lt;v<sub>x</sub>, 0&gt; - still moving horizontally</p>
                </div>
                <p class="secondary" style="margin-top: 2rem; color: #ef4444;">Acceleration is ALWAYS &lt;0, -g&gt;, pointing down</p>
                <p class="secondary" style="margin-top: 0.5rem;">Even at the peak, gravity acts!</p>
            </div>
        </div>

        <!-- Slide 3: Review - The Derivative Chain -->
        <div class="slide slide-visual" data-slide="3" data-section="The Derivative Chain" data-title="From 1D to 2D Motion">
            <div class="slide-content">
                <h2>From 1D to 2D Motion</h2>
                <div class="formula-box" style="margin-bottom: 1.5rem;">
                    <p style="font-size: 1.25rem; color: var(--text-tertiary);">1D Chain:</p>
                    <p style="font-size: 1.5rem; font-family: var(--font-mono);">s(t) → v(t) = s'(t) → a(t) = s''(t)</p>
                </div>
                <div class="formula-box highlight">
                    <p style="font-size: 1.25rem; color: var(--text-tertiary);">2D Chain (with vectors):</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem;"><strong>Position:</strong> \(\mathbf{r}(t) = \langle x(t), y(t) \rangle\)</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem;"><strong>Velocity:</strong> \(\mathbf{v}(t) = \mathbf{r}'(t) = \langle x'(t), y'(t) \rangle\)</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem;"><strong>Acceleration:</strong> \(\mathbf{a}(t) = \mathbf{r}''(t) = \langle x''(t), y''(t) \rangle\)</p>
                </div>
                <p class="caption" style="margin-top: 1.5rem;">Same derivative relationships, now with vectors!</p>
            </div>
        </div>

        <!-- Slide 4: Velocity Vector Analysis -->
        <div class="slide slide-two-part" data-slide="4" data-section="Velocity" data-title="Velocity Vector Analysis">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">The Velocity Vector</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.75rem;">$$\mathbf{v}(t) = \mathbf{r}'(t) = \left\langle \frac{dx}{dt}, \frac{dy}{dt} \right\rangle$$</p>
                </div>
                <div style="text-align: left; max-width: 700px; margin: 1.5rem auto 0;">
                    <p class="secondary" style="margin-bottom: 0.75rem;"><strong>Direction:</strong> Points in direction of motion (tangent to curve)</p>
                    <p class="secondary" style="margin-bottom: 0.75rem;"><strong>Components:</strong> \(v_x\) = horizontal velocity, \(v_y\) = vertical velocity</p>
                    <p class="secondary"><strong>Magnitude:</strong> \(|\mathbf{v}(t)| = \text{speed} = \sqrt{v_x^2 + v_y^2}\)</p>
                </div>
            </div>
        </div>

        <!-- Slide 5: Velocity vs. Speed -->
        <div class="slide slide-comparison" data-slide="5" data-section="Velocity" data-title="Velocity vs. Speed">
            <div class="slide-content">
                <h2>Critical Distinction</h2>
                <div class="columns">
                    <div class="column">
                        <h3 style="color: #f97316;">Velocity (VECTOR)</h3>
                        <ul style="list-style: none; margin-top: 1rem; font-size: 1.25rem;">
                            <li style="padding: 0.5rem 0;">\(\mathbf{v}(t) = \langle v_x(t), v_y(t) \rangle\)</li>
                            <li style="padding: 0.5rem 0;">Has magnitude AND direction</li>
                            <li style="padding: 0.5rem 0;">Can have negative components</li>
                            <li style="padding: 0.5rem 0;">Points in direction of motion</li>
                        </ul>
                    </div>
                    <div class="column">
                        <h3 style="color: #22c55e;">Speed (SCALAR)</h3>
                        <ul style="list-style: none; margin-top: 1rem; font-size: 1.25rem;">
                            <li style="padding: 0.5rem 0;">\(|\mathbf{v}(t)| = \sqrt{v_x^2 + v_y^2}\)</li>
                            <li style="padding: 0.5rem 0;">Magnitude only</li>
                            <li style="padding: 0.5rem 0;">Always non-negative</li>
                            <li style="padding: 0.5rem 0;">How fast, not which way</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: Linear Motion Example -->
        <div class="slide slide-example" data-slide="6" data-section="Velocity" data-title="Linear Motion Example">
            <div class="slide-content">
                <h2>Example: Linear Motion</h2>
                <div class="step-solution">
                    <div class="step">
                        <div class="step-header">Given:</div>
                        <p style="font-size: 1.5rem;">\(\mathbf{r}(t) = \langle 1 + 2t, 3 - t \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Velocity:</div>
                        <p style="font-size: 1.5rem;">\(\mathbf{v}(t) = \mathbf{r}'(t) = \langle 2, -1 \rangle\) (constant velocity)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Speed:</div>
                        <p style="font-size: 1.5rem;">\(|\mathbf{v}| = \sqrt{4 + 1} = \sqrt{5}\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Interpretation:</div>
                        <ul style="font-size: 1.25rem; margin-left: 1.5rem;">
                            <li>Moving right (\(v_x = 2 > 0\))</li>
                            <li>Moving down (\(v_y = -1 < 0\))</li>
                            <li>Constant speed \(\sqrt{5}\) in a straight line</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Projectile Motion Example -->
        <div class="slide slide-visual" data-slide="7" data-section="Velocity" data-title="Projectile Motion Example">
            <div class="slide-content">
                <h2>Example: Projectile Motion</h2>
                <div id="projectile-velocity-viz" class="visualization"></div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.25rem;">Given: \(\mathbf{r}(t) = \langle 50t, 80t - 16t^2 \rangle\)</p>
                    <p style="font-size: 1.25rem; margin-top: 0.5rem;">\(\mathbf{v}(t) = \langle 50, 80 - 32t \rangle\)</p>
                </div>
                <div class="data-display" style="max-width: 600px; margin: 1rem auto 0;">
                    <div class="data-item"><div class="label">At t = 0</div><div class="value">v = &lt;50, 80&gt;, speed = 94.3</div></div>
                    <div class="data-item"><div class="label">At t = 2.5 (peak)</div><div class="value">v = &lt;50, 0&gt;, speed = 50</div></div>
                </div>
                <p class="caption">Horizontal velocity constant; vertical velocity changes linearly</p>
            </div>
        </div>

        <!-- Slide 8: When is the Particle at Rest? -->
        <div class="slide slide-two-part" data-slide="8" data-section="Velocity" data-title="When is the Particle at Rest?">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">At Rest?</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.5rem;">At rest means \(\mathbf{v}(t) = \langle 0, 0 \rangle\)</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem; color: #ef4444;"><strong>BOTH</strong> components must be zero!</p>
                </div>
                <div class="secondary" style="margin-top: 2rem;">
                    <p style="font-size: 1.25rem; color: var(--text-tertiary);">For \(\mathbf{r}(t) = \langle 50t, 80t - 16t^2 \rangle\):</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem;">\(v_x = 50\) is <strong>never</strong> zero</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem; color: var(--accent-secondary);">The particle is NEVER at rest!</p>
                    <p style="font-size: 1.25rem; margin-top: 0.5rem;">At the peak, it's still moving horizontally</p>
                </div>
            </div>
        </div>

        <!-- Slide 9: Acceleration Vector Analysis -->
        <div class="slide slide-two-part" data-slide="9" data-section="Acceleration" data-title="Acceleration Vector Analysis">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">The Acceleration Vector</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.75rem;">$$\mathbf{a}(t) = \mathbf{v}'(t) = \mathbf{r}''(t) = \left\langle \frac{d^2x}{dt^2}, \frac{d^2y}{dt^2} \right\rangle$$</p>
                </div>
                <div class="key-insight" style="margin-top: 1.5rem;">
                    <p style="font-size: 1.25rem;"><strong>Key Insight:</strong></p>
                    <ul style="font-size: 1.25rem; margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Acceleration is rate of change of VELOCITY</li>
                        <li>Changes in both magnitude (speed) AND direction</li>
                        <li style="color: #ef4444;">Does NOT necessarily point in direction of motion!</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 10: Projectile Acceleration -->
        <div class="slide slide-visual" data-slide="10" data-section="Acceleration" data-title="Projectile Acceleration">
            <div class="slide-content">
                <h2>Projectile Motion: Acceleration</h2>
                <div id="projectile-accel-viz" class="visualization"></div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.25rem;">Given: \(\mathbf{r}(t) = \langle 50t, 80t - 16t^2 \rangle\)</p>
                    <p style="font-size: 1.25rem; margin-top: 0.25rem;">\(\mathbf{v}(t) = \langle 50, 80 - 32t \rangle\)</p>
                    <p style="font-size: 1.25rem; margin-top: 0.25rem; color: #ef4444;">\(\mathbf{a}(t) = \langle 0, -32 \rangle\) (constant!)</p>
                </div>
                <p class="caption">Acceleration always points DOWN, regardless of position</p>
            </div>
        </div>

        <!-- Slide 11: Circular Motion - A Surprise -->
        <div class="slide slide-visual" data-slide="11" data-section="Acceleration" data-title="Circular Motion">
            <div class="slide-content">
                <h2>Circular Motion Analysis</h2>
                <div id="circular-motion-viz" class="visualization"></div>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.25rem;">\(\mathbf{r}(t) = \langle 3\cos(t), 3\sin(t) \rangle\)</p>
                    <p style="font-size: 1.25rem; margin-top: 0.25rem; color: #f97316;">\(\mathbf{v}(t) = \langle -3\sin(t), 3\cos(t) \rangle\)</p>
                    <p style="font-size: 1.25rem; margin-top: 0.25rem; color: #ef4444;">\(\mathbf{a}(t) = \langle -3\cos(t), -3\sin(t) \rangle = -\mathbf{r}(t)\)</p>
                </div>
                <p class="caption" style="color: var(--accent-secondary);">Acceleration points toward CENTER! This is centripetal acceleration.</p>
            </div>
        </div>

        <!-- Slide 12: Constant Speed on Circle -->
        <div class="slide slide-statement" data-slide="12" data-section="Acceleration" data-title="Constant Speed on Circle">
            <div class="slide-content">
                <p class="statement">On a circle, speed is constant even though velocity changes!</p>
                <div class="formula-box" style="margin-top: 2rem; display: inline-block;">
                    <p style="font-size: 1.5rem;">Speed = \(|\mathbf{v}(t)| = \sqrt{9\sin^2(t) + 9\cos^2(t)} = 3\)</p>
                </div>
                <p class="secondary" style="margin-top: 2rem;">Acceleration only changes DIRECTION, not speed</p>
            </div>
        </div>

        <!-- Slide 13: Speeding Up vs. Slowing Down -->
        <div class="slide slide-two-part" data-slide="13" data-section="Acceleration" data-title="Speeding Up vs. Slowing Down">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">The 2D Rule</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.5rem;">Use the dot product: \(\mathbf{v} \cdot \mathbf{a}\)</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem;">\(\mathbf{v} \cdot \mathbf{a} = v_x \cdot a_x + v_y \cdot a_y\)</p>
                </div>
                <div class="secondary" style="margin-top: 1.5rem;">
                    <p style="font-size: 1.5rem; color: #22c55e;">\(\mathbf{v} \cdot \mathbf{a} > 0\): Speeding up</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem; color: #ef4444;">\(\mathbf{v} \cdot \mathbf{a} < 0\): Slowing down</p>
                    <p style="font-size: 1.5rem; margin-top: 0.5rem; color: var(--theme-color);">\(\mathbf{v} \cdot \mathbf{a} = 0\): Constant speed (direction changing only)</p>
                </div>
            </div>
        </div>

        <!-- Slide 14: Dot Product Example -->
        <div class="slide slide-example" data-slide="14" data-section="Acceleration" data-title="Dot Product Example">
            <div class="slide-content">
                <h2>Verifying Constant Speed on Circle</h2>
                <div class="step-solution">
                    <div class="step">
                        <div class="step-header">Velocity:</div>
                        <p style="font-size: 1.5rem;">\(\mathbf{v}(t) = \langle -3\sin(t), 3\cos(t) \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Acceleration:</div>
                        <p style="font-size: 1.5rem;">\(\mathbf{a}(t) = \langle -3\cos(t), -3\sin(t) \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Dot Product:</div>
                        <p style="font-size: 1.5rem;">\(\mathbf{v} \cdot \mathbf{a} = (-3\sin t)(-3\cos t) + (3\cos t)(-3\sin t)\)</p>
                        <p style="font-size: 1.5rem; margin-top: 0.5rem;">\(= 9\sin t \cos t - 9\cos t \sin t = 0\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Conclusion:</div>
                        <p style="font-size: 1.5rem; color: var(--theme-color);">Speed is constant! Acceleration only changes direction.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 15: Motion Simulator -->
        <div class="slide slide-visual" data-slide="15" data-section="Visualization" data-title="Motion Simulator">
            <div class="slide-content">
                <h2>Motion Simulator</h2>
                <div id="motion-simulator-viz" class="visualization"></div>
                <div class="viz-controls">
                    <select id="curve-selector" style="padding: 0.5rem; font-size: 1rem; border-radius: 6px;">
                        <option value="projectile">Projectile</option>
                        <option value="circle">Circle</option>
                        <option value="figure8">Figure-8</option>
                    </select>
                    <button id="play-pause-btn">Play</button>
                    <label>t: <input type="range" id="time-slider" min="0" max="100" value="0"></label>
                    <label><input type="checkbox" id="show-velocity" checked> Velocity</label>
                    <label><input type="checkbox" id="show-accel" checked> Acceleration</label>
                </div>
                <p class="caption">Watch how velocity and acceleration interact</p>
            </div>
        </div>

        <!-- Slide 16: Distance vs. Displacement -->
        <div class="slide slide-statement" data-slide="16" data-section="Distance and Displacement" data-title="Distance vs. Displacement">
            <div class="slide-content">
                <p class="statement">Distance and Displacement are NOT the same!</p>
                <p class="secondary" style="margin-top: 2rem;">A round trip has zero displacement but positive distance.</p>
            </div>
        </div>

        <!-- Slide 17: Displacement (Vector) -->
        <div class="slide slide-two-part" data-slide="17" data-section="Distance and Displacement" data-title="Displacement">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">Displacement (Vector)</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.75rem;">$$\Delta \mathbf{r} = \mathbf{r}(t_2) - \mathbf{r}(t_1)$$</p>
                    <p style="font-size: 1.25rem; margin-top: 0.5rem;">Straight-line vector from start to end</p>
                </div>
                <div class="secondary" style="margin-top: 1.5rem;">
                    <ul style="font-size: 1.25rem; list-style: none; text-align: center;">
                        <li style="padding: 0.5rem 0;">Can be zero even if particle moved!</li>
                        <li style="padding: 0.5rem 0;">Ignores the actual path taken</li>
                        <li style="padding: 0.5rem 0;">Magnitude \(|\Delta \mathbf{r}|\) = straight-line distance</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 18: Total Distance (Scalar) -->
        <div class="slide slide-two-part" data-slide="18" data-section="Distance and Displacement" data-title="Total Distance">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">Total Distance (Scalar)</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.5rem;">$$\text{Distance} = \int_{t_1}^{t_2} |\mathbf{v}(t)|\, dt = \int_{t_1}^{t_2} \sqrt{\left(\frac{dx}{dt}\right)^2 + \left(\frac{dy}{dt}\right)^2}\, dt$$</p>
                </div>
                <div class="key-insight" style="margin-top: 1.5rem;">
                    <p style="font-size: 1.5rem; color: var(--accent-secondary);">This is the ARC LENGTH formula!</p>
                    <ul style="font-size: 1.25rem; margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Distance = integral of speed</li>
                        <li>Always non-negative, accounts for ALL travel</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 19: Distance vs. Displacement Visual -->
        <div class="slide slide-visual" data-slide="19" data-section="Distance and Displacement" data-title="Visual Comparison">
            <div class="slide-content">
                <h2>Comparing Distance and Displacement</h2>
                <div id="distance-displacement-viz" class="visualization"></div>
                <div class="data-display" style="max-width: 500px; margin: 1rem auto 0;">
                    <div class="data-item" style="border-top: 3px solid #22c55e;"><div class="label">Distance Traveled</div><div class="value" id="distance-value">8.00 units</div></div>
                    <div class="data-item" style="border-top: 3px solid #ef4444;"><div class="label">Displacement</div><div class="value" id="displacement-value">|&lt;0, 0&gt;| = 0</div></div>
                </div>
                <p class="caption">Same start and end, but traveled a curved path</p>
            </div>
        </div>

        <!-- Slide 20: Integration for Position -->
        <div class="slide slide-two-part" data-slide="20" data-section="Integration" data-title="Integration for Position">
            <div class="slide-content">
                <p class="primary" style="color: var(--theme-color);">The Formulas</p>
                <div class="formula-box" style="margin-top: 1rem;">
                    <p style="font-size: 1.25rem; color: var(--text-tertiary);">Velocity from acceleration:</p>
                    <p style="font-size: 1.5rem;">$$\mathbf{v}(t) = \int \mathbf{a}(t)\, dt + \mathbf{v}_0$$</p>
                    <p style="font-size: 1.25rem; color: var(--text-tertiary); margin-top: 1rem;">Position from velocity:</p>
                    <p style="font-size: 1.5rem;">$$\mathbf{r}(t) = \int \mathbf{v}(t)\, dt + \mathbf{r}_0$$</p>
                </div>
                <div class="key-insight" style="margin-top: 1rem;">
                    <p style="font-size: 1.25rem; color: #ef4444;"><strong>Critical Note:</strong> Initial conditions are ESSENTIAL!</p>
                    <p style="font-size: 1.25rem;">The constants are VECTORS</p>
                </div>
            </div>
        </div>

        <!-- Slide 21: Integration Example -->
        <div class="slide slide-example" data-slide="21" data-section="Integration" data-title="Integration Example">
            <div class="slide-content">
                <h2>Finding Position from Acceleration</h2>
                <div class="step-solution">
                    <div class="step">
                        <div class="step-header">Given:</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{a}(t) = \langle 2, -6t \rangle\), \(\mathbf{v}(0) = \langle 1, 4 \rangle\), \(\mathbf{r}(0) = \langle 0, 0 \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Step 1 - Find v(t):</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{v}(t) = \int \langle 2, -6t \rangle\, dt + \mathbf{v}(0)\)</p>
                        <p style="font-size: 1.25rem; margin-top: 0.25rem;">\(\mathbf{v}(t) = \langle 2t, -3t^2 \rangle + \langle 1, 4 \rangle = \langle 2t + 1, -3t^2 + 4 \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">Step 2 - Find r(t):</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{r}(t) = \int \langle 2t + 1, -3t^2 + 4 \rangle\, dt + \mathbf{r}(0)\)</p>
                        <p style="font-size: 1.25rem; margin-top: 0.25rem;">\(\mathbf{r}(t) = \langle t^2 + t, -t^3 + 4t \rangle + \langle 0, 0 \rangle = \langle t^2 + t, -t^3 + 4t \rangle\)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 22: Practice Problem -->
        <div class="slide slide-exercise" data-slide="22" data-section="Practice" data-title="Practice Problem">
            <div class="slide-content">
                <h2>Your Turn</h2>
                <div class="prompt">
                    <p style="font-size: 1.5rem;">Given: \(\mathbf{r}(t) = \langle t^2, t^3 - 3t \rangle\)</p>
                </div>
                <div class="instructions" style="text-align: left; max-width: 600px; margin: 1.5rem auto 0;">
                    <p style="font-size: 1.25rem; margin-bottom: 1rem;">Find:</p>
                    <ol style="list-style-position: inside; font-size: 1.25rem;">
                        <li style="padding: 0.5rem 0;">a) \(\mathbf{v}(t)\) and \(\mathbf{v}(1)\)</li>
                        <li style="padding: 0.5rem 0;">b) \(\mathbf{a}(t)\) and \(\mathbf{a}(1)\)</li>
                        <li style="padding: 0.5rem 0;">c) Speed at \(t = 1\)</li>
                        <li style="padding: 0.5rem 0;">d) Is the particle speeding up or slowing down at \(t = 1\)?</li>
                    </ol>
                </div>
                <p style="font-size: 1.5rem; color: var(--theme-color); margin-top: 1.5rem;">Time: 4 minutes</p>
            </div>
        </div>

        <!-- Slide 23: Practice Solution -->
        <div class="slide slide-example" data-slide="23" data-section="Practice" data-title="Practice Solution">
            <div class="slide-content">
                <h2>Solution</h2>
                <div class="step-solution">
                    <div class="step">
                        <div class="step-header">a) Velocity:</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{v}(t) = \langle 2t, 3t^2 - 3 \rangle\), \(\mathbf{v}(1) = \langle 2, 0 \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">b) Acceleration:</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{a}(t) = \langle 2, 6t \rangle\), \(\mathbf{a}(1) = \langle 2, 6 \rangle\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">c) Speed at t = 1:</div>
                        <p style="font-size: 1.25rem;">\(|\mathbf{v}(1)| = |\langle 2, 0 \rangle| = 2\)</p>
                    </div>
                    <div class="step">
                        <div class="step-header">d) Speeding up/down?</div>
                        <p style="font-size: 1.25rem;">\(\mathbf{v}(1) \cdot \mathbf{a}(1) = (2)(2) + (0)(6) = 4 > 0\)</p>
                        <p style="font-size: 1.25rem; color: #22c55e; margin-top: 0.5rem;">The particle is <strong>SPEEDING UP</strong> at t = 1</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 24: Key Formulas Summary -->
        <div class="slide slide-list" data-slide="24" data-section="Summary" data-title="Key Formulas">
            <div class="slide-content">
                <h2>Key Formulas</h2>
                <ul>
                    <li><strong>Position:</strong> \(\mathbf{r}(t) = \langle x(t), y(t) \rangle\)</li>
                    <li><strong>Velocity:</strong> \(\mathbf{v}(t) = \mathbf{r}'(t) = \langle x'(t), y'(t) \rangle\)</li>
                    <li><strong>Acceleration:</strong> \(\mathbf{a}(t) = \mathbf{r}''(t) = \langle x''(t), y''(t) \rangle\)</li>
                    <li><strong>Speed:</strong> \(|\mathbf{v}(t)| = \sqrt{(x')^2 + (y')^2}\)</li>
                    <li><strong>Distance:</strong> \(\int |\mathbf{v}(t)|\, dt\)</li>
                    <li><strong>Speeding up/down:</strong> Sign of \(\mathbf{v} \cdot \mathbf{a}\)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 25: Key Takeaways -->
        <div class="slide slide-list" data-slide="25" data-section="Summary" data-title="Key Takeaways">
            <div class="slide-content">
                <h2>Key Takeaways</h2>
                <ul>
                    <li>Position → velocity → acceleration: derivative chain</li>
                    <li>Velocity is a VECTOR; speed is its magnitude</li>
                    <li>Acceleration doesn't always point in direction of motion</li>
                    <li>Distance \(\neq\) |displacement| in general</li>
                    <li>Use \(\mathbf{v} \cdot \mathbf{a}\) to determine speeding up/slowing down</li>
                    <li>Initial conditions are essential for integration</li>
                </ul>
            </div>
        </div>

        <!-- Slide 26: Exit Ticket -->
        <div class="slide slide-exercise" data-slide="26" data-section="Closing" data-title="Exit Ticket">
            <div class="slide-content">
                <h2>Exit Ticket</h2>
                <div class="prompt">
                    <p style="font-size: 1.5rem;">A particle moves so that \(\mathbf{r}(t) = \langle \cos(2t), \sin(2t) \rangle\).</p>
                </div>
                <div class="instructions" style="text-align: left; max-width: 600px; margin: 1.5rem auto 0;">
                    <ol style="list-style-position: inside; font-size: 1.25rem;">
                        <li style="padding: 0.5rem 0;">Find the speed at any time t.</li>
                        <li style="padding: 0.5rem 0;">Is the particle ever speeding up or slowing down?</li>
                        <li style="padding: 0.5rem 0;">What is the total distance traveled from t = 0 to t = \(\pi\)?</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Slide 27: Coming Up -->
        <div class="slide slide-statement" data-slide="27" data-section="Closing" data-title="Coming Up">
            <div class="slide-content">
                <p class="statement">Next: Polar Coordinates</p>
                <p class="secondary" style="margin-top: 2rem;">A completely different way to describe curves - using distance and angle</p>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>

        <!-- Slide Counter -->
        <div class="slide-counter">1 / 28</div>

        <!-- Keyboard Hint -->
        <div class="keyboard-hint">
            <kbd>←</kbd> <kbd>→</kbd> Navigate | <kbd>T</kbd> TOC | <kbd>S</kbd> Syllabus | <kbd>F</kbd> Fullscreen
        </div>

        <!-- Overlay Backdrop -->
        <div id="overlay-backdrop" class="overlay-backdrop"></div>

        <!-- TOC Overlay -->
        <div id="toc-overlay" class="toc-overlay">
            <button id="toc-close" class="toc-close">&times;</button>
            <div class="toc-header">
                <h3>Table of Contents</h3>
                <div class="class-info">Class 52: Motion in the Plane</div>
            </div>
            <div id="toc-content" class="toc-content"></div>
            <div class="toc-footer">
                <a href="../index.html">← Back to Course Syllabus</a>
            </div>
        </div>

        <!-- Appendix Overlay -->
        <div id="appendix-overlay" class="appendix-overlay">
            <div class="appendix-header">
                <h3>Appendix</h3>
                <button id="appendix-close" class="appendix-close">&times;</button>
            </div>
            <div id="appendix-content" class="appendix-content"></div>
            <div class="appendix-nav">
                <button id="appendix-prev" class="appendix-nav-btn">← Prev</button>
                <span id="appendix-counter" class="appendix-counter">1 / 1</span>
                <button id="appendix-next" class="appendix-nav-btn">Next →</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="../shared/presentation.js"></script>
    <script>
        // ===== Color Constants =====
        const COLORS = {
            path: '#60a5fa',
            particle: '#0891b2',
            velocity: '#f97316',
            acceleration: '#ef4444',
            position: '#94a3b8',
            speedingUp: '#22c55e',
            slowingDown: '#ef4444',
            distance: '#22c55e',
            displacement: '#ef4444'
        };

        // ===== Projectile Question Visualization (Slide 1) =====
        function drawProjectileQuestion() {
            const container = document.getElementById('projectile-question-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 700;
            const height = 350;
            const margin = { top: 30, right: 40, bottom: 50, left: 60 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // Scales
            const xScale = d3.scaleLinear().domain([0, 250]).range([0, plotWidth]);
            const yScale = d3.scaleLinear().domain([0, 120]).range([plotHeight, 0]);

            // Projectile equations: r(t) = <50t, 80t - 16t^2>
            const getX = t => 50 * t;
            const getY = t => 80 * t - 16 * t * t;
            const tMax = 5; // lands at t=5
            const tPeak = 2.5; // peak at t=2.5

            // Draw axes
            g.append('line')
                .attr('x1', 0).attr('y1', plotHeight)
                .attr('x2', plotWidth).attr('y2', plotHeight)
                .attr('stroke', '#4a5568').attr('stroke-width', 2);

            g.append('line')
                .attr('x1', 0).attr('y1', 0)
                .attr('x2', 0).attr('y2', plotHeight)
                .attr('stroke', '#4a5568').attr('stroke-width', 2);

            // Draw path
            const pathData = d3.range(0, tMax + 0.1, 0.05).map(t => ({
                x: xScale(getX(t)),
                y: yScale(Math.max(0, getY(t)))
            }));

            const line = d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom);

            g.append('path')
                .datum(pathData)
                .attr('fill', 'none')
                .attr('stroke', COLORS.path)
                .attr('stroke-width', 3)
                .attr('d', line);

            // Highlight peak point
            const peakX = getX(tPeak);
            const peakY = getY(tPeak);

            g.append('circle')
                .attr('cx', xScale(peakX))
                .attr('cy', yScale(peakY))
                .attr('r', 12)
                .attr('fill', COLORS.particle)
                .attr('stroke', 'white')
                .attr('stroke-width', 2);

            g.append('text')
                .attr('x', xScale(peakX))
                .attr('y', yScale(peakY) - 25)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('fill', COLORS.particle)
                .attr('font-weight', '600')
                .text('Peak');

            // Question marks at peak
            g.append('text')
                .attr('x', xScale(peakX) + 40)
                .attr('y', yScale(peakY) - 10)
                .attr('font-size', '1.5rem')
                .attr('fill', COLORS.velocity)
                .text('v = ?');

            g.append('text')
                .attr('x', xScale(peakX) + 40)
                .attr('y', yScale(peakY) + 25)
                .attr('font-size', '1.5rem')
                .attr('fill', COLORS.acceleration)
                .text('a = ?');

            // Animate ball
            const ball = g.append('circle')
                .attr('r', 8)
                .attr('fill', '#fbbf24');

            function animateBall() {
                ball.attr('cx', xScale(getX(0))).attr('cy', yScale(getY(0)))
                    .transition()
                    .duration(3000)
                    .ease(d3.easeLinear)
                    .attrTween('cx', () => t => xScale(getX(t * tMax)))
                    .attrTween('cy', () => t => yScale(Math.max(0, getY(t * tMax))))
                    .on('end', () => setTimeout(animateBall, 500));
            }
            animateBall();
        }

        // ===== Projectile with Velocity Vectors (Slide 7) =====
        function drawProjectileVelocity() {
            const container = document.getElementById('projectile-velocity-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 700;
            const height = 300;
            const margin = { top: 20, right: 40, bottom: 40, left: 50 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const xScale = d3.scaleLinear().domain([0, 260]).range([0, plotWidth]);
            const yScale = d3.scaleLinear().domain([0, 110]).range([plotHeight, 0]);

            const getX = t => 50 * t;
            const getY = t => 80 * t - 16 * t * t;
            const getVx = t => 50;
            const getVy = t => 80 - 32 * t;
            const tMax = 5;

            // Draw path
            const pathData = d3.range(0, tMax + 0.1, 0.05).map(t => ({
                x: xScale(getX(t)),
                y: yScale(Math.max(0, getY(t)))
            }));

            g.append('path')
                .datum(pathData)
                .attr('fill', 'none')
                .attr('stroke', COLORS.path)
                .attr('stroke-width', 3)
                .attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom));

            // Draw velocity vectors at key times
            const times = [0, 1.25, 2.5, 3.75, 5];
            const vectorScale = 0.6;

            times.forEach(t => {
                const x = getX(t);
                const y = Math.max(0, getY(t));
                const vx = getVx(t) * vectorScale;
                const vy = getVy(t) * vectorScale;

                // Velocity vector
                g.append('line')
                    .attr('x1', xScale(x))
                    .attr('y1', yScale(y))
                    .attr('x2', xScale(x) + vx)
                    .attr('y2', yScale(y) - vy)
                    .attr('stroke', COLORS.velocity)
                    .attr('stroke-width', 3)
                    .attr('marker-end', 'url(#arrow-velocity)');

                // Point
                g.append('circle')
                    .attr('cx', xScale(x))
                    .attr('cy', yScale(y))
                    .attr('r', 6)
                    .attr('fill', COLORS.particle);
            });

            // Arrow marker
            svg.append('defs').append('marker')
                .attr('id', 'arrow-velocity')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 8)
                .attr('refY', 0)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-4L10,0L0,4')
                .attr('fill', COLORS.velocity);

            // Legend
            g.append('rect').attr('x', plotWidth - 120).attr('y', 10).attr('width', 15).attr('height', 15).attr('fill', COLORS.velocity);
            g.append('text').attr('x', plotWidth - 100).attr('y', 22).attr('font-size', '1.25rem').attr('fill', '#b8c4d6').text('Velocity');
        }

        // ===== Projectile with Acceleration Vectors (Slide 10) =====
        function drawProjectileAccel() {
            const container = document.getElementById('projectile-accel-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 700;
            const height = 300;
            const margin = { top: 20, right: 40, bottom: 40, left: 50 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const defs = svg.append('defs');
            defs.append('marker')
                .attr('id', 'arrow-accel')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 8)
                .attr('refY', 0)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-4L10,0L0,4')
                .attr('fill', COLORS.acceleration);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const xScale = d3.scaleLinear().domain([0, 260]).range([0, plotWidth]);
            const yScale = d3.scaleLinear().domain([0, 110]).range([plotHeight, 0]);

            const getX = t => 50 * t;
            const getY = t => 80 * t - 16 * t * t;
            const tMax = 5;

            // Draw path
            const pathData = d3.range(0, tMax + 0.1, 0.05).map(t => ({
                x: xScale(getX(t)),
                y: yScale(Math.max(0, getY(t)))
            }));

            g.append('path')
                .datum(pathData)
                .attr('fill', 'none')
                .attr('stroke', COLORS.path)
                .attr('stroke-width', 3)
                .attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom));

            // Draw acceleration vectors at key times (all pointing down!)
            const times = [0.5, 1.5, 2.5, 3.5, 4.5];
            const accelLength = 40;

            times.forEach(t => {
                const x = getX(t);
                const y = Math.max(0, getY(t));

                // Acceleration vector (always pointing down)
                g.append('line')
                    .attr('x1', xScale(x))
                    .attr('y1', yScale(y))
                    .attr('x2', xScale(x))
                    .attr('y2', yScale(y) + accelLength)
                    .attr('stroke', COLORS.acceleration)
                    .attr('stroke-width', 3)
                    .attr('marker-end', 'url(#arrow-accel)');

                // Point
                g.append('circle')
                    .attr('cx', xScale(x))
                    .attr('cy', yScale(y))
                    .attr('r', 6)
                    .attr('fill', COLORS.particle);
            });

            // Legend
            g.append('rect').attr('x', plotWidth - 140).attr('y', 10).attr('width', 15).attr('height', 15).attr('fill', COLORS.acceleration);
            g.append('text').attr('x', plotWidth - 120).attr('y', 22).attr('font-size', '1.25rem').attr('fill', '#b8c4d6').text('Acceleration');
        }

        // ===== Circular Motion Visualization (Slide 11) =====
        function drawCircularMotion() {
            const container = document.getElementById('circular-motion-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 600;
            const height = 350;
            const cx = width / 2;
            const cy = height / 2;
            const radius = 120;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const defs = svg.append('defs');

            // Arrow markers
            ['velocity', 'acceleration', 'position'].forEach((type, i) => {
                const color = type === 'velocity' ? COLORS.velocity :
                              type === 'acceleration' ? COLORS.acceleration : COLORS.position;
                defs.append('marker')
                    .attr('id', `arrow-${type}`)
                    .attr('viewBox', '0 -5 10 10')
                    .attr('refX', 8)
                    .attr('refY', 0)
                    .attr('markerWidth', 6)
                    .attr('markerHeight', 6)
                    .attr('orient', 'auto')
                    .append('path')
                    .attr('d', 'M0,-4L10,0L0,4')
                    .attr('fill', color);
            });

            // Draw circle
            svg.append('circle')
                .attr('cx', cx)
                .attr('cy', cy)
                .attr('r', radius)
                .attr('fill', 'none')
                .attr('stroke', COLORS.path)
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '8,4');

            // Center point
            svg.append('circle')
                .attr('cx', cx)
                .attr('cy', cy)
                .attr('r', 4)
                .attr('fill', '#94a3b8');

            // Moving point and vectors
            const point = svg.append('circle')
                .attr('r', 10)
                .attr('fill', COLORS.particle);

            const posVector = svg.append('line')
                .attr('stroke', COLORS.position)
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '4,4')
                .attr('marker-end', 'url(#arrow-position)');

            const velVector = svg.append('line')
                .attr('stroke', COLORS.velocity)
                .attr('stroke-width', 3)
                .attr('marker-end', 'url(#arrow-velocity)');

            const accelVector = svg.append('line')
                .attr('stroke', COLORS.acceleration)
                .attr('stroke-width', 3)
                .attr('marker-end', 'url(#arrow-acceleration)');

            // Legend
            const legend = svg.append('g').attr('transform', `translate(20, 20)`);

            [
                { label: 'Position r(t)', color: COLORS.position },
                { label: 'Velocity v(t)', color: COLORS.velocity },
                { label: 'Accel a(t)', color: COLORS.acceleration }
            ].forEach((item, i) => {
                legend.append('rect')
                    .attr('x', 0).attr('y', i * 25)
                    .attr('width', 15).attr('height', 15)
                    .attr('fill', item.color);
                legend.append('text')
                    .attr('x', 20).attr('y', i * 25 + 12)
                    .attr('font-size', '1rem')
                    .attr('fill', '#b8c4d6')
                    .text(item.label);
            });

            // v dot a display
            const dotProductText = svg.append('text')
                .attr('x', width - 20)
                .attr('y', 30)
                .attr('text-anchor', 'end')
                .attr('font-size', '1.25rem')
                .attr('fill', COLORS.particle)
                .text('v · a = 0');

            // Animation
            let t = 0;
            const vectorScale = 30;

            function animate() {
                t += 0.02;

                const x = cx + radius * Math.cos(t);
                const y = cy + radius * Math.sin(t);

                // r(t) = <3cos(t), 3sin(t)>
                // v(t) = <-3sin(t), 3cos(t)>
                // a(t) = <-3cos(t), -3sin(t)>

                const vx = -Math.sin(t) * vectorScale;
                const vy = Math.cos(t) * vectorScale;
                const ax = -Math.cos(t) * vectorScale;
                const ay = -Math.sin(t) * vectorScale;

                point.attr('cx', x).attr('cy', y);

                posVector
                    .attr('x1', cx).attr('y1', cy)
                    .attr('x2', x).attr('y2', y);

                velVector
                    .attr('x1', x).attr('y1', y)
                    .attr('x2', x + vx).attr('y2', y + vy);

                accelVector
                    .attr('x1', x).attr('y1', y)
                    .attr('x2', x + ax).attr('y2', y + ay);

                requestAnimationFrame(animate);
            }
            animate();
        }

        // ===== Motion Simulator (Slide 15) =====
        function drawMotionSimulator() {
            const container = document.getElementById('motion-simulator-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 700;
            const height = 350;
            const margin = { top: 20, right: 100, bottom: 40, left: 50 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const defs = svg.append('defs');
            ['vel', 'acc'].forEach((type, i) => {
                const color = type === 'vel' ? COLORS.velocity : COLORS.acceleration;
                defs.append('marker')
                    .attr('id', `sim-arrow-${type}`)
                    .attr('viewBox', '0 -5 10 10')
                    .attr('refX', 8)
                    .attr('refY', 0)
                    .attr('markerWidth', 5)
                    .attr('markerHeight', 5)
                    .attr('orient', 'auto')
                    .append('path')
                    .attr('d', 'M0,-4L10,0L0,4')
                    .attr('fill', color);
            });

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // Curves
            const curves = {
                projectile: {
                    x: t => 50 * t,
                    y: t => 80 * t - 16 * t * t,
                    tMax: 5,
                    scale: { x: [0, 260], y: [0, 110] }
                },
                circle: {
                    x: t => 100 + 80 * Math.cos(t),
                    y: t => 80 + 80 * Math.sin(t),
                    tMax: 2 * Math.PI,
                    scale: { x: [0, 200], y: [0, 180] }
                },
                figure8: {
                    x: t => 100 + 80 * Math.sin(t),
                    y: t => 80 + 40 * Math.sin(2 * t),
                    tMax: 2 * Math.PI,
                    scale: { x: [0, 200], y: [0, 160] }
                }
            };

            let currentCurve = 'projectile';
            let isPlaying = false;
            let currentT = 0;

            const xScale = d3.scaleLinear().range([0, plotWidth]);
            const yScale = d3.scaleLinear().range([plotHeight, 0]);

            const pathLine = g.append('path')
                .attr('fill', 'none')
                .attr('stroke', COLORS.path)
                .attr('stroke-width', 2);

            const particle = g.append('circle')
                .attr('r', 8)
                .attr('fill', COLORS.particle);

            const velVector = g.append('line')
                .attr('stroke', COLORS.velocity)
                .attr('stroke-width', 3)
                .attr('marker-end', 'url(#sim-arrow-vel)');

            const accVector = g.append('line')
                .attr('stroke', COLORS.acceleration)
                .attr('stroke-width', 3)
                .attr('marker-end', 'url(#sim-arrow-acc)');

            // Info display
            const infoG = svg.append('g').attr('transform', `translate(${width - 90}, 30)`);
            const speedText = infoG.append('text').attr('font-size', '1.25rem').attr('fill', '#b8c4d6');
            const dotText = infoG.append('text').attr('y', 25).attr('font-size', '1.25rem');

            function updateCurve() {
                const curve = curves[currentCurve];
                xScale.domain(curve.scale.x);
                yScale.domain(curve.scale.y);

                const pathData = d3.range(0, curve.tMax + 0.01, curve.tMax / 100).map(t => ({
                    x: xScale(curve.x(t)),
                    y: yScale(curve.y(t))
                }));

                pathLine.datum(pathData)
                    .attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom));

                currentT = 0;
                updatePosition();
            }

            function updatePosition() {
                const curve = curves[currentCurve];
                const t = currentT * curve.tMax / 100;
                const dt = 0.001;

                const x = curve.x(t);
                const y = curve.y(t);

                // Numerical derivatives
                const vx = (curve.x(t + dt) - curve.x(t - dt)) / (2 * dt);
                const vy = (curve.y(t + dt) - curve.y(t - dt)) / (2 * dt);
                const ax = (curve.x(t + dt) - 2 * curve.x(t) + curve.x(t - dt)) / (dt * dt);
                const ay = (curve.y(t + dt) - 2 * curve.y(t) + curve.y(t - dt)) / (dt * dt);

                const speed = Math.sqrt(vx * vx + vy * vy);
                const vDotA = vx * ax + vy * ay;

                const vectorScale = currentCurve === 'projectile' ? 0.5 : 15;

                particle.attr('cx', xScale(x)).attr('cy', yScale(y));

                const showVel = document.getElementById('show-velocity')?.checked;
                const showAcc = document.getElementById('show-accel')?.checked;

                velVector
                    .attr('x1', xScale(x)).attr('y1', yScale(y))
                    .attr('x2', xScale(x) + vx * vectorScale)
                    .attr('y2', yScale(y) - vy * vectorScale)
                    .attr('opacity', showVel ? 1 : 0);

                accVector
                    .attr('x1', xScale(x)).attr('y1', yScale(y))
                    .attr('x2', xScale(x) + ax * vectorScale * 0.5)
                    .attr('y2', yScale(y) - ay * vectorScale * 0.5)
                    .attr('opacity', showAcc ? 1 : 0);

                speedText.text(`Speed: ${speed.toFixed(1)}`);
                dotText.text(`v·a: ${vDotA.toFixed(1)}`)
                    .attr('fill', vDotA > 0.5 ? COLORS.speedingUp : vDotA < -0.5 ? COLORS.slowingDown : COLORS.particle);
            }

            function animate() {
                if (isPlaying) {
                    currentT = (currentT + 0.5) % 100;
                    document.getElementById('time-slider').value = currentT;
                    updatePosition();
                }
                requestAnimationFrame(animate);
            }

            // Event listeners
            document.getElementById('curve-selector')?.addEventListener('change', e => {
                currentCurve = e.target.value;
                updateCurve();
            });

            document.getElementById('play-pause-btn')?.addEventListener('click', e => {
                isPlaying = !isPlaying;
                e.target.textContent = isPlaying ? 'Pause' : 'Play';
            });

            document.getElementById('time-slider')?.addEventListener('input', e => {
                currentT = parseFloat(e.target.value);
                updatePosition();
            });

            document.getElementById('show-velocity')?.addEventListener('change', updatePosition);
            document.getElementById('show-accel')?.addEventListener('change', updatePosition);

            updateCurve();
            animate();
        }

        // ===== Distance vs Displacement Visualization (Slide 19) =====
        function drawDistanceDisplacement() {
            const container = document.getElementById('distance-displacement-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 600;
            const height = 300;
            const cx = width / 2;
            const cy = height / 2 + 30;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            // Cycloid-like path: r(t) = <t - sin(t), 1 - cos(t)> scaled
            const scale = 40;
            const getX = t => cx - 100 + (t - Math.sin(t)) * scale;
            const getY = t => cy - (1 - Math.cos(t)) * scale;
            const tMax = 2 * Math.PI;

            // Draw path
            const pathData = d3.range(0, tMax + 0.01, 0.05).map(t => ({
                x: getX(t),
                y: getY(t)
            }));

            // Path background (total distance)
            svg.append('path')
                .datum(pathData)
                .attr('fill', 'none')
                .attr('stroke', COLORS.distance)
                .attr('stroke-width', 4)
                .attr('opacity', 0.5)
                .attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom));

            // Displacement "vector" (it's zero in this case - just a point)
            const startX = getX(0);
            const startY = getY(0);
            const endX = getX(tMax);
            const endY = getY(tMax);

            // Start/end point (same location for full cycle)
            svg.append('circle')
                .attr('cx', startX)
                .attr('cy', startY)
                .attr('r', 10)
                .attr('fill', COLORS.particle)
                .attr('stroke', 'white')
                .attr('stroke-width', 2);

            svg.append('text')
                .attr('x', startX)
                .attr('y', startY + 30)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('fill', COLORS.particle)
                .text('Start = End');

            // Animated particle
            const particle = svg.append('circle')
                .attr('r', 6)
                .attr('fill', '#fbbf24');

            // Trail
            const trail = svg.append('path')
                .attr('fill', 'none')
                .attr('stroke', COLORS.distance)
                .attr('stroke-width', 3);

            let trailData = [];
            let t = 0;

            function animate() {
                t += 0.03;
                if (t > tMax) {
                    t = 0;
                    trailData = [];
                }

                const x = getX(t);
                const y = getY(t);

                particle.attr('cx', x).attr('cy', y);

                trailData.push({ x, y });
                trail.datum(trailData)
                    .attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom));

                // Update displays
                const distance = t * scale * 1.5; // Approximate arc length
                const dispX = x - startX;
                const dispY = y - startY;
                const dispMag = Math.sqrt(dispX * dispX + dispY * dispY);

                const distEl = document.getElementById('distance-value');
                const dispEl = document.getElementById('displacement-value');
                if (distEl) distEl.textContent = distance.toFixed(1) + ' units';
                if (dispEl) dispEl.textContent = `|<${dispX.toFixed(0)}, ${(startY - y).toFixed(0)}>| = ${dispMag.toFixed(1)}`;

                requestAnimationFrame(animate);
            }
            animate();

            // Legend
            const legend = svg.append('g').attr('transform', 'translate(20, 20)');
            legend.append('rect').attr('width', 15).attr('height', 15).attr('fill', COLORS.distance);
            legend.append('text').attr('x', 20).attr('y', 12).attr('font-size', '1rem').attr('fill', '#b8c4d6').text('Distance (path)');
        }

        // ===== Visualization Trigger System =====
        const visualizationSlides = {
            1: drawProjectileQuestion,
            7: drawProjectileVelocity,
            10: drawProjectileAccel,
            11: drawCircularMotion,
            15: drawMotionSimulator,
            19: drawDistanceDisplacement
        };

        let lastSlide = -1;

        function checkAndDrawVisualization() {
            if (!window.Presentation) return;

            const currentSlide = window.Presentation.getCurrentSlide();
            if (currentSlide !== lastSlide) {
                lastSlide = currentSlide;
                if (visualizationSlides[currentSlide]) {
                    setTimeout(visualizationSlides[currentSlide], 100);
                }
            }
        }

        // Check periodically for slide changes
        setInterval(checkAndDrawVisualization, 200);

        // Also check on hash changes
        window.addEventListener('hashchange', () => {
            setTimeout(checkAndDrawVisualization, 100);
        });

        // Initial check after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(checkAndDrawVisualization, 200);
            });
        } else {
            setTimeout(checkAndDrawVisualization, 200);
        }
    </script>
</body>
</html>
