<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class 60: Absolute and Conditional Convergence | AP Calculus BC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../shared/styles.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --theme-color: #4f46e5;
            --theme-color-light: #6366f1;
        }

        /* Custom styles for this presentation */
        .definition-box {
            background: var(--bg-secondary);
            border-left: 4px solid #d4a028;
            padding: 1.5rem 2rem;
            border-radius: 0 12px 12px 0;
            margin: 1.5rem 0;
            max-width: 800px;
        }

        .definition-box p {
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }

        .theorem-box {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(99, 102, 241, 0.05));
            border: 2px solid var(--theme-color);
            padding: 1.5rem 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            max-width: 800px;
        }

        .theorem-box p {
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }

        .interpretation {
            font-size: 1.25rem;
            color: var(--text-secondary);
            font-style: italic;
            margin-top: 1rem;
        }

        .category-table {
            width: 100%;
            max-width: 700px;
            margin: 1.5rem auto;
            border-collapse: collapse;
            font-size: 1.25rem;
        }

        .category-table th,
        .category-table td {
            padding: 1rem 1.5rem;
            text-align: center;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .category-table th {
            background: var(--bg-secondary);
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1.25rem;
        }

        .category-table tr:nth-child(odd) td {
            background: rgba(79, 70, 229, 0.05);
        }

        .test-table {
            width: 100%;
            max-width: 800px;
            margin: 1.5rem auto;
            border-collapse: collapse;
            font-size: 1.25rem;
        }

        .test-table th,
        .test-table td {
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .test-table th {
            background: var(--bg-secondary);
            font-family: var(--font-display);
            font-weight: 600;
        }

        .solution-box {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            border-radius: 12px;
            margin: 1rem 0;
            text-align: left;
            max-width: 800px;
        }

        .solution-box p {
            font-size: 1.35rem;
            margin: 0.75rem 0;
        }

        .solution-box .step {
            color: var(--text-secondary);
        }

        .solution-box .conclusion {
            color: var(--theme-color);
            font-weight: 600;
        }

        .rearrangement-demo {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            border-radius: 12px;
            margin: 1rem 0;
            max-width: 850px;
        }

        .rearrangement-demo p {
            font-size: 1.35rem;
            margin: 0.75rem 0;
        }

        .practice-list {
            text-align: left;
            max-width: 700px;
            margin: 1.5rem auto;
        }

        .practice-list li {
            font-size: 1.35rem;
            padding: 0.75rem 0;
        }

        .bc-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--theme-color), var(--theme-color-light));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 0.5rem;
            vertical-align: middle;
        }

        .flowchart-text {
            background: var(--bg-secondary);
            padding: 1.5rem 2rem;
            border-radius: 12px;
            text-align: left;
            max-width: 700px;
            margin: 1rem auto;
        }

        .flowchart-text p {
            font-size: 1.35rem;
            margin: 0.5rem 0;
            padding-left: 1rem;
        }

        .flowchart-text .indent {
            padding-left: 2rem;
            color: var(--text-secondary);
        }

        .flowchart-text .outcome {
            font-weight: 600;
        }

        .flowchart-text .outcome.abs { color: #22c55e; }
        .flowchart-text .outcome.cond { color: #fbbf24; }
        .flowchart-text .outcome.div { color: #f97316; }
    </style>
</head>
<body>
    <div class="presentation">
        <!-- Slide 0: Title -->
        <div class="slide slide-title" data-slide="0" data-section="Opening" data-title="Absolute and Conditional Convergence">
            <div class="slide-content">
                <div class="unit-badge">Unit 10: Infinite Sequences and Series <span class="bc-badge">BC Only</span></div>
                <h1>Absolute and Conditional Convergence</h1>
                <p class="subtitle">Strong vs Weak Convergence</p>
                <p class="meta">Class 60 | CED 10.9 | NCSSM</p>
            </div>
        </div>

        <!-- Slide 1: Opening Hook -->
        <div class="slide slide-statement" data-slide="1" data-section="Opening" data-title="Opening Hook">
            <div class="slide-content">
                <p class="statement">We proved \(\displaystyle\sum \frac{(-1)^n}{n}\) converges (alternating harmonic)</p>
                <p class="statement" style="margin-top: 2rem; color: var(--theme-color);">What about \(\displaystyle\sum \left|\frac{(-1)^n}{n}\right| = \sum \frac{1}{n}\)?</p>
            </div>
        </div>

        <!-- Slide 2: The Contrast -->
        <div class="slide slide-comparison" data-slide="2" data-section="Opening" data-title="A Tale of Two Series">
            <div class="slide-content">
                <h2>A Tale of Two Series</h2>
                <div class="columns">
                    <div class="column">
                        <h3 style="color: #22c55e;">\(\displaystyle\sum \frac{(-1)^n}{n}\)</h3>
                        <p style="font-size: 1.75rem; color: #22c55e; margin-top: 1rem;">Converges (to \(\ln 2\))</p>
                        <p style="font-size: 1.35rem; margin-top: 0.5rem;">AST applies</p>
                    </div>
                    <div class="column">
                        <h3 style="color: #f97316;">\(\displaystyle\sum \frac{1}{n}\)</h3>
                        <p style="font-size: 1.75rem; color: #f97316; margin-top: 1rem;">Diverges!</p>
                        <p style="font-size: 1.35rem; margin-top: 0.5rem;">Harmonic series</p>
                    </div>
                </div>
                <p class="caption" style="margin-top: 2rem; font-size: 1.35rem;">The original converges only because of cancellation between positive and negative terms</p>
            </div>
        </div>

        <!-- Slide 3: Absolute Convergence Definition -->
        <div class="slide slide-visual" data-slide="3" data-section="Definitions" data-title="Absolute Convergence">
            <div class="slide-content">
                <h2>Absolute Convergence</h2>
                <div class="definition-box">
                    <p>A series \(\displaystyle\sum a_n\) <strong>converges absolutely</strong> if \(\displaystyle\sum |a_n|\) converges</p>
                </div>
                <p class="interpretation">The series converges even when all terms are made positive</p>
            </div>
        </div>

        <!-- Slide 4: Key Theorem -->
        <div class="slide slide-visual" data-slide="4" data-section="Definitions" data-title="Key Theorem">
            <div class="slide-content">
                <h2>Absolute Convergence Implies Convergence</h2>
                <div class="theorem-box">
                    <p>If \(\displaystyle\sum |a_n|\) converges, then \(\displaystyle\sum a_n\) converges</p>
                </div>
                <p class="interpretation" style="max-width: 700px; margin: 1.5rem auto 0;">Taking absolute values can only make convergence "harder." If it converges with all positive terms, it definitely converges with the original signs.</p>
            </div>
        </div>

        <!-- Slide 5: Conditional Convergence Definition -->
        <div class="slide slide-visual" data-slide="5" data-section="Definitions" data-title="Conditional Convergence">
            <div class="slide-content">
                <h2>Conditional Convergence</h2>
                <div class="definition-box">
                    <p>A series \(\displaystyle\sum a_n\) <strong>converges conditionally</strong> if:</p>
                    <p style="padding-left: 1rem;">1. \(\displaystyle\sum a_n\) converges</p>
                    <p style="padding-left: 1rem;">2. \(\displaystyle\sum |a_n|\) diverges</p>
                </div>
                <p class="interpretation">The series converges only because of cancellation between positive and negative terms</p>
            </div>
        </div>

        <!-- Slide 6: The Three Categories -->
        <div class="slide slide-visual" data-slide="6" data-section="Definitions" data-title="Three Types">
            <div class="slide-content">
                <h2>Three Types of Series</h2>
                <table class="category-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>\(\sum a_n\)</th>
                            <th>\(\sum |a_n|\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="color: #f97316; font-weight: 600;">Divergent</td>
                            <td>Diverges</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td style="color: #fbbf24; font-weight: 600;">Conditionally Convergent</td>
                            <td>Converges</td>
                            <td>Diverges</td>
                        </tr>
                        <tr>
                            <td style="color: #22c55e; font-weight: 600;">Absolutely Convergent</td>
                            <td>Converges</td>
                            <td>Converges</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Slide 7: Hierarchy Visualization -->
        <div class="slide slide-visual" data-slide="7" data-section="Definitions" data-title="Convergence Hierarchy">
            <div class="slide-content">
                <h2>The Convergence Hierarchy</h2>
                <div id="hierarchy-viz" class="visualization"></div>
                <p class="caption">Absolute convergence is the strongest property</p>
            </div>
        </div>

        <!-- Slide 8: Important Observation -->
        <div class="slide slide-statement" data-slide="8" data-section="Definitions" data-title="Important Observation">
            <div class="slide-content">
                <p class="statement">A series with all positive terms cannot be conditionally convergent</p>
                <p style="font-size: 1.5rem; color: var(--text-secondary); margin-top: 2rem; max-width: 700px;">If \(a_n \geq 0\) for all \(n\), then \(|a_n| = a_n\), so both series are identical</p>
                <p style="font-size: 1.5rem; color: var(--theme-color); margin-top: 1.5rem;">Conditional convergence only occurs when terms alternate in sign</p>
            </div>
        </div>

        <!-- Slide 9: Classification Algorithm -->
        <div class="slide slide-visual" data-slide="9" data-section="Classification" data-title="Classification Procedure">
            <div class="slide-content">
                <h2>Classification Procedure</h2>
                <div class="flowchart-text">
                    <p><strong>Start:</strong> Test \(\sum |a_n|\)</p>
                    <p class="indent">If \(\sum |a_n|\) converges: <span class="outcome abs">ABSOLUTELY CONVERGENT</span> (done)</p>
                    <p class="indent">If \(\sum |a_n|\) diverges: Test \(\sum a_n\)</p>
                    <p class="indent" style="padding-left: 3rem;">If \(\sum a_n\) converges: <span class="outcome cond">CONDITIONALLY CONVERGENT</span></p>
                    <p class="indent" style="padding-left: 3rem;">If \(\sum a_n\) diverges: <span class="outcome div">DIVERGENT</span></p>
                </div>
            </div>
        </div>

        <!-- Slide 10: Interactive Classification Flowchart -->
        <div class="slide slide-visual" data-slide="10" data-section="Classification" data-title="Classification Flowchart">
            <div class="slide-content">
                <h2>Classification Flowchart</h2>
                <div id="flowchart-viz" class="visualization"></div>
                <p class="caption">Follow the algorithm to classify any series</p>
            </div>
        </div>

        <!-- Slide 11: Which Tests Give What -->
        <div class="slide slide-visual" data-slide="11" data-section="Classification" data-title="Tests and Results">
            <div class="slide-content">
                <h2>Which Tests Give Which Result</h2>
                <table class="test-table">
                    <thead>
                        <tr>
                            <th>Test</th>
                            <th>Result When Applicable</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ratio test (\(L < 1\))</td>
                            <td style="color: #22c55e;">Absolute convergence</td>
                        </tr>
                        <tr>
                            <td>Root test (\(L < 1\))</td>
                            <td style="color: #22c55e;">Absolute convergence</td>
                        </tr>
                        <tr>
                            <td>Comparison on \(|a_n|\)</td>
                            <td style="color: #22c55e;">Absolute convergence</td>
                        </tr>
                        <tr>
                            <td>Integral test on \(|a_n|\)</td>
                            <td style="color: #22c55e;">Absolute convergence</td>
                        </tr>
                        <tr>
                            <td>Alternating Series Test</td>
                            <td style="color: #fbbf24;">Convergence (must check absolute separately)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Slide 12: Example 1 - Absolutely Convergent -->
        <div class="slide slide-example" data-slide="12" data-section="Worked Examples" data-title="Example 1">
            <div class="slide-content">
                <h2>Example 1: Absolutely Convergent</h2>
                <p style="font-size: 1.75rem; margin-bottom: 1.5rem;">Classify: \(\displaystyle\sum \frac{(-1)^n}{n^2}\)</p>
                <div class="solution-box">
                    <p class="step">Test \(\sum |a_n| = \sum \dfrac{1}{n^2}\)</p>
                    <p class="step">p-series with \(p = 2 > 1\) \(\rightarrow\) <strong>Converges</strong></p>
                    <p class="conclusion">Since \(\sum |a_n|\) converges, \(\sum a_n\) converges <strong>ABSOLUTELY</strong></p>
                </div>
            </div>
        </div>

        <!-- Slide 13: Example 2 - Conditionally Convergent -->
        <div class="slide slide-example" data-slide="13" data-section="Worked Examples" data-title="Example 2">
            <div class="slide-content">
                <h2>Example 2: Conditionally Convergent</h2>
                <p style="font-size: 1.75rem; margin-bottom: 1.5rem;">Classify: \(\displaystyle\sum \frac{(-1)^n}{n}\)</p>
                <div class="solution-box">
                    <p class="step">Test \(\sum |a_n| = \sum \dfrac{1}{n}\) (harmonic) \(\rightarrow\) <strong style="color: #f97316;">Diverges</strong></p>
                    <p class="step">Test \(\sum a_n\): AST with \(b_n = 1/n\)</p>
                    <p class="step" style="padding-left: 1.5rem;">Decreasing? Yes. \(\lim_{n\to\infty} b_n = 0\)? Yes.</p>
                    <p class="step">\(\sum a_n\) <strong style="color: #22c55e;">converges</strong></p>
                    <p class="conclusion">\(\sum |a_n|\) diverges but \(\sum a_n\) converges \(\rightarrow\) <strong style="color: #fbbf24;">CONDITIONALLY</strong></p>
                </div>
            </div>
        </div>

        <!-- Slide 14: Example 3 - Divergent -->
        <div class="slide slide-example" data-slide="14" data-section="Worked Examples" data-title="Example 3">
            <div class="slide-content">
                <h2>Example 3: Divergent</h2>
                <p style="font-size: 1.75rem; margin-bottom: 1.5rem;">Classify: \(\displaystyle\sum (-1)^n \cdot \frac{n}{n+1}\)</p>
                <div class="solution-box">
                    <p class="step">Test for convergence: \(\displaystyle\lim_{n\to\infty} |a_n| = \lim_{n\to\infty} \frac{n}{n+1} = 1 \neq 0\)</p>
                    <p class="step">By nth term test, \(\sum a_n\) <strong style="color: #f97316;">DIVERGES</strong></p>
                    <p class="conclusion">(No need to test \(\sum |a_n|\) - already know it diverges)</p>
                </div>
            </div>
        </div>

        <!-- Slide 15: Example 4 - Using Ratio Test -->
        <div class="slide slide-example" data-slide="15" data-section="Worked Examples" data-title="Example 4">
            <div class="slide-content">
                <h2>Example 4: Using Ratio Test</h2>
                <p style="font-size: 1.75rem; margin-bottom: 1.5rem;">Classify: \(\displaystyle\sum \frac{(-1)^n \cdot n}{3^n}\)</p>
                <div class="solution-box">
                    <p class="step">Ratio test: \(\left|\dfrac{a_{n+1}}{a_n}\right| = \dfrac{(n+1)/3^{n+1}}{n/3^n} = \dfrac{n+1}{3n}\)</p>
                    <p class="step">\(L = \displaystyle\lim_{n\to\infty} \dfrac{n+1}{3n} = \dfrac{1}{3} < 1\)</p>
                    <p class="conclusion">Ratio test with \(L < 1\) gives <strong style="color: #22c55e;">absolute convergence</strong></p>
                </div>
            </div>
        </div>

        <!-- Slide 16: Example 5 - Conditional Variant -->
        <div class="slide slide-example" data-slide="16" data-section="Worked Examples" data-title="Example 5">
            <div class="slide-content">
                <h2>Example 5</h2>
                <p style="font-size: 1.75rem; margin-bottom: 1.5rem;">Classify: \(\displaystyle\sum \frac{(-1)^n}{\sqrt{n}}\)</p>
                <div class="solution-box">
                    <p class="step">Test \(\sum |a_n| = \sum \dfrac{1}{\sqrt{n}} = \sum \dfrac{1}{n^{1/2}}\)</p>
                    <p class="step">p-series with \(p = 1/2 < 1\) \(\rightarrow\) <strong style="color: #f97316;">Diverges</strong></p>
                    <p class="step">Test \(\sum a_n\): AST applies (\(1/\sqrt{n}\) decreasing, \(\lim = 0\)) \(\rightarrow\) <strong style="color: #22c55e;">Converges</strong></p>
                    <p class="conclusion"><strong style="color: #fbbf24;">CONDITIONALLY convergent</strong></p>
                </div>
            </div>
        </div>

        <!-- Slide 17: Partial Sum Comparison -->
        <div class="slide slide-visual" data-slide="17" data-section="Visualization" data-title="Partial Sum Comparison">
            <div class="slide-content">
                <h2>Comparing \(\sum a_n\) and \(\sum |a_n|\)</h2>
                <div id="partial-sum-viz" class="visualization"></div>
                <p class="caption">Same terms, very different behavior</p>
            </div>
        </div>

        <!-- Slide 18: Why It Matters - Rearrangement -->
        <div class="slide slide-statement" data-slide="18" data-section="Rearrangement" data-title="Why It Matters">
            <div class="slide-content">
                <p class="statement">Why does the distinction matter?</p>
                <p style="font-size: 1.75rem; color: var(--text-secondary); margin-top: 2rem; max-width: 750px;">Absolutely convergent series can be rearranged freely.</p>
                <p style="font-size: 1.75rem; color: var(--theme-color); margin-top: 1rem;">Conditionally convergent series <em>cannot!</em></p>
            </div>
        </div>

        <!-- Slide 19: The Riemann Rearrangement Theorem -->
        <div class="slide slide-visual" data-slide="19" data-section="Rearrangement" data-title="Riemann Rearrangement">
            <div class="slide-content">
                <h2>The Riemann Rearrangement Theorem</h2>
                <div class="theorem-box" style="max-width: 850px;">
                    <p>If \(\sum a_n\) converges <strong>conditionally</strong>, then for ANY real number \(S\), there exists a rearrangement of the terms that converges to \(S\)</p>
                    <p style="margin-top: 1rem; color: var(--accent-secondary);">You can even rearrange to diverge to \(\pm\infty\)!</p>
                </div>
                <p class="interpretation" style="font-size: 1.5rem; margin-top: 1.5rem;">Same terms, any sum you want!</p>
            </div>
        </div>

        <!-- Slide 20: Rearrangement Demonstration -->
        <div class="slide slide-visual" data-slide="20" data-section="Rearrangement" data-title="Rearrangement Example">
            <div class="slide-content">
                <h2>Rearrangement Example</h2>
                <div class="rearrangement-demo">
                    <p><strong>Standard order:</strong></p>
                    <p style="color: var(--theme-color);">\(1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \cdots = \ln 2 \approx 0.693\)</p>
                    <p style="margin-top: 1.5rem;"><strong>Rearranged (two positive, one negative):</strong></p>
                    <p style="color: #fbbf24;">\(1 + \frac{1}{3} - \frac{1}{2} + \frac{1}{5} + \frac{1}{7} - \frac{1}{4} + \cdots = \frac{3}{2}\ln 2 \approx 1.04\)</p>
                </div>
                <p class="caption" style="margin-top: 1.5rem; font-size: 1.5rem; color: var(--accent-secondary);">Same terms, different sum!</p>
            </div>
        </div>

        <!-- Slide 21: Stability Summary -->
        <div class="slide slide-comparison" data-slide="21" data-section="Summary" data-title="Convergence Stability">
            <div class="slide-content">
                <h2>Convergence Stability</h2>
                <div class="columns">
                    <div class="column">
                        <h3 style="color: #22c55e;">Absolutely Convergent</h3>
                        <ul style="list-style: none; margin-top: 1rem; text-align: left;">
                            <li style="padding: 0.5rem 0; font-size: 1.35rem;">Rearrangement doesn't change sum</li>
                            <li style="padding: 0.5rem 0; font-size: 1.35rem;">Can multiply, integrate, differentiate</li>
                            <li style="padding: 0.5rem 0; font-size: 1.5rem; color: #22c55e; font-weight: 600;">STABLE</li>
                        </ul>
                    </div>
                    <div class="column">
                        <h3 style="color: #fbbf24;">Conditionally Convergent</h3>
                        <ul style="list-style: none; margin-top: 1rem; text-align: left;">
                            <li style="padding: 0.5rem 0; font-size: 1.35rem;">Rearrangement CAN change sum</li>
                            <li style="padding: 0.5rem 0; font-size: 1.35rem;">More delicate operations</li>
                            <li style="padding: 0.5rem 0; font-size: 1.5rem; color: #fbbf24; font-weight: 600;">FRAGILE</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 22: Classification Practice -->
        <div class="slide slide-exercise" data-slide="22" data-section="Practice" data-title="Quick Classification">
            <div class="slide-content">
                <h2>Quick Classification</h2>
                <div class="prompt">
                    <p>Classify each as Divergent / Conditionally Convergent / Absolutely Convergent:</p>
                </div>
                <ol class="practice-list">
                    <li>\(\displaystyle\sum \frac{(-1)^n}{n^3}\)</li>
                    <li>\(\displaystyle\sum \frac{(-1)^n \ln(n)}{n}\)</li>
                    <li>\(\displaystyle\sum \frac{\cos(n\pi)}{n^{0.9}}\)</li>
                    <li>\(\displaystyle\sum \frac{(-1)^n \cdot 2^n}{n!}\)</li>
                </ol>
                <p class="caption" style="margin-top: 1.5rem;">Time: 3 minutes</p>
            </div>
        </div>

        <!-- Slide 23: Practice Solutions -->
        <div class="slide slide-list" data-slide="23" data-section="Practice" data-title="Solutions">
            <div class="slide-content">
                <h2>Solutions</h2>
                <ul>
                    <li>\(\sum 1/n^3\) converges (p-series, \(p=3\)) \(\rightarrow\) <strong style="color: #22c55e;">Absolute</strong></li>
                    <li>\(\sum |\cdot| = \sum \ln(n)/n\) diverges (compare to \(\sum 1/n\)), but AST applies \(\rightarrow\) <strong style="color: #fbbf24;">Conditional</strong></li>
                    <li>\(\cos(n\pi) = (-1)^n\), so p-series \(p=0.9<1\) diverges, but alternating \(\rightarrow\) <strong style="color: #fbbf24;">Conditional</strong></li>
                    <li>Ratio test: \(L = 2/(n+1) \to 0 < 1\) \(\rightarrow\) <strong style="color: #22c55e;">Absolute</strong></li>
                </ul>
            </div>
        </div>

        <!-- Slide 24: Summary Table -->
        <div class="slide slide-visual" data-slide="24" data-section="Summary" data-title="Summary Table">
            <div class="slide-content">
                <h2>Summary</h2>
                <table class="test-table">
                    <thead>
                        <tr>
                            <th>To Determine</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Absolute convergence</td>
                            <td>Test \(\sum |a_n|\) for convergence</td>
                        </tr>
                        <tr>
                            <td>Conditional convergence</td>
                            <td>\(\sum |a_n|\) diverges AND \(\sum a_n\) converges</td>
                        </tr>
                        <tr>
                            <td>Which test to use</td>
                            <td>Ratio \(\rightarrow\) absolute; AST \(\rightarrow\) check separately</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Slide 25: Key Takeaways -->
        <div class="slide slide-list" data-slide="25" data-section="Summary" data-title="Key Takeaways">
            <div class="slide-content">
                <h2>Key Takeaways</h2>
                <ul>
                    <li><strong>Absolute:</strong> \(\sum |a_n|\) converges \(\rightarrow\) "strong" convergence</li>
                    <li><strong>Conditional:</strong> \(\sum a_n\) converges but \(\sum |a_n|\) diverges \(\rightarrow\) "weak" convergence</li>
                    <li>Always test \(\sum |a_n|\) <strong>FIRST</strong> in the classification algorithm</li>
                    <li>Ratio test gives absolute convergence when \(L < 1\)</li>
                    <li>Conditionally convergent series can be rearranged to any sum!</li>
                </ul>
            </div>
        </div>

        <!-- Slide 26: Exit Ticket -->
        <div class="slide slide-exercise" data-slide="26" data-section="Closing" data-title="Exit Ticket">
            <div class="slide-content">
                <h2>Exit Ticket</h2>
                <div class="prompt">
                    <ol class="practice-list">
                        <li>Define absolute and conditional convergence.</li>
                        <li>Classify \(\displaystyle\sum \frac{(-1)^n}{n+5}\) with justification.</li>
                        <li>Why does absolute convergence "imply" convergence?</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Slide 27: Coming Up -->
        <div class="slide slide-statement" data-slide="27" data-section="Closing" data-title="Coming Up">
            <div class="slide-content">
                <p class="statement">Next: Taylor Polynomials</p>
                <p style="font-size: 1.75rem; color: var(--text-secondary); margin-top: 1.5rem;">Using polynomials to approximate functions</p>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>

        <!-- Slide Counter -->
        <div class="slide-counter">1 / 28</div>

        <!-- Keyboard Hint -->
        <div class="keyboard-hint">
            <kbd>←</kbd> <kbd>→</kbd> Navigate | <kbd>T</kbd> TOC | <kbd>S</kbd> Syllabus | <kbd>F</kbd> Fullscreen
        </div>

        <!-- Overlay Backdrop -->
        <div id="overlay-backdrop" class="overlay-backdrop"></div>

        <!-- TOC Overlay -->
        <div id="toc-overlay" class="toc-overlay">
            <button id="toc-close" class="toc-close">&times;</button>
            <div class="toc-header">
                <h3>Table of Contents</h3>
                <div class="class-info">Class 60: Absolute and Conditional Convergence</div>
            </div>
            <div id="toc-content" class="toc-content"></div>
            <div class="toc-footer">
                <a href="../index.html">Back to Course Syllabus</a>
            </div>
        </div>

        <!-- Appendix Overlay -->
        <div id="appendix-overlay" class="appendix-overlay">
            <div class="appendix-header">
                <h3>Appendix</h3>
                <button id="appendix-close" class="appendix-close">&times;</button>
            </div>
            <div id="appendix-content" class="appendix-content"></div>
            <div class="appendix-nav">
                <button id="appendix-prev" class="appendix-nav-btn">Prev</button>
                <span id="appendix-counter" class="appendix-counter">1 / 1</span>
                <button id="appendix-next" class="appendix-nav-btn">Next</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="../shared/presentation.js"></script>
    <script>
        // ===== Visualization 1: Convergence Hierarchy (Slide 7) =====
        function drawHierarchy() {
            const container = document.getElementById('hierarchy-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 700;
            const height = 400;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            const centerX = width / 2;
            const centerY = height / 2;

            // Define regions as nested ellipses
            const regions = [
                { rx: 320, ry: 170, color: '#f97316', label: 'All Series (Divergent region)', labelY: -150 },
                { rx: 220, ry: 120, color: '#fbbf24', label: 'Convergent (Conditional region)', labelY: -100 },
                { rx: 100, ry: 60, color: '#22c55e', label: 'Absolutely Convergent', labelY: 0 }
            ];

            // Draw regions from outermost to innermost
            regions.forEach((region, i) => {
                svg.append('ellipse')
                    .attr('cx', centerX)
                    .attr('cy', centerY)
                    .attr('rx', region.rx)
                    .attr('ry', region.ry)
                    .attr('fill', region.color)
                    .attr('fill-opacity', 0.3)
                    .attr('stroke', region.color)
                    .attr('stroke-width', 3);
            });

            // Labels
            svg.append('text')
                .attr('x', centerX)
                .attr('y', centerY - 150)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#f97316')
                .attr('font-weight', '600')
                .text('Divergent');

            svg.append('text')
                .attr('x', centerX)
                .attr('y', centerY - 90)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#fbbf24')
                .attr('font-weight', '600')
                .text('Conditionally Convergent');

            svg.append('text')
                .attr('x', centerX)
                .attr('y', centerY + 5)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#22c55e')
                .attr('font-weight', '600')
                .text('Absolutely');

            svg.append('text')
                .attr('x', centerX)
                .attr('y', centerY + 25)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#22c55e')
                .attr('font-weight', '600')
                .text('Convergent');

            // Example series in each region
            svg.append('text')
                .attr('x', centerX + 200)
                .attr('y', centerY + 140)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'JetBrains Mono, monospace')
                .attr('fill', '#f97316')
                .text('\u03A3 1');

            svg.append('text')
                .attr('x', centerX - 150)
                .attr('y', centerY + 70)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'JetBrains Mono, monospace')
                .attr('fill', '#fbbf24')
                .text('\u03A3 (-1)\u207F/n');

            svg.append('text')
                .attr('x', centerX)
                .attr('y', centerY + 50)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('font-family', 'JetBrains Mono, monospace')
                .attr('fill', '#22c55e')
                .text('\u03A3 1/n\u00B2');
        }

        // ===== Visualization 2: Classification Flowchart (Slide 10) =====
        function drawFlowchart() {
            const container = document.getElementById('flowchart-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 800;
            const height = 420;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            // Define arrow marker
            const defs = svg.append('defs');
            defs.append('marker')
                .attr('id', 'arrow-flow')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 10)
                .attr('refY', 0)
                .attr('markerWidth', 8)
                .attr('markerHeight', 8)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-4L10,0L0,4')
                .attr('fill', '#6b7a94');

            // Nodes
            const nodes = [
                { id: 'start', x: 400, y: 50, text: 'Does \u03A3|a\u2099| converge?', type: 'decision', color: '#4f46e5' },
                { id: 'abs', x: 650, y: 130, text: 'ABSOLUTELY\nCONVERGENT', type: 'outcome', color: '#22c55e' },
                { id: 'test2', x: 200, y: 200, text: 'Does \u03A3a\u2099 converge?', type: 'decision', color: '#4f46e5' },
                { id: 'cond', x: 400, y: 320, text: 'CONDITIONALLY\nCONVERGENT', type: 'outcome', color: '#fbbf24' },
                { id: 'div', x: 100, y: 350, text: 'DIVERGENT', type: 'outcome', color: '#f97316' }
            ];

            // Draw connections first
            // Start -> Abs (Yes)
            svg.append('path')
                .attr('d', 'M500,60 Q575,60 575,100 L575,115')
                .attr('fill', 'none')
                .attr('stroke', '#6b7a94')
                .attr('stroke-width', 2)
                .attr('marker-end', 'url(#arrow-flow)');

            svg.append('text')
                .attr('x', 540)
                .attr('y', 55)
                .attr('font-size', '1.25rem')
                .attr('fill', '#22c55e')
                .text('Yes');

            // Start -> Test2 (No)
            svg.append('path')
                .attr('d', 'M300,60 Q200,60 200,120 L200,170')
                .attr('fill', 'none')
                .attr('stroke', '#6b7a94')
                .attr('stroke-width', 2)
                .attr('marker-end', 'url(#arrow-flow)');

            svg.append('text')
                .attr('x', 240)
                .attr('y', 55)
                .attr('font-size', '1.25rem')
                .attr('fill', '#f97316')
                .text('No');

            // Test2 -> Cond (Yes)
            svg.append('path')
                .attr('d', 'M300,210 Q350,210 350,260 L350,295')
                .attr('fill', 'none')
                .attr('stroke', '#6b7a94')
                .attr('stroke-width', 2)
                .attr('marker-end', 'url(#arrow-flow)');

            svg.append('text')
                .attr('x', 310)
                .attr('y', 215)
                .attr('font-size', '1.25rem')
                .attr('fill', '#22c55e')
                .text('Yes');

            // Test2 -> Div (No)
            svg.append('path')
                .attr('d', 'M100,210 Q100,280 100,325')
                .attr('fill', 'none')
                .attr('stroke', '#6b7a94')
                .attr('stroke-width', 2)
                .attr('marker-end', 'url(#arrow-flow)');

            svg.append('text')
                .attr('x', 70)
                .attr('y', 260)
                .attr('font-size', '1.25rem')
                .attr('fill', '#f97316')
                .text('No');

            // Draw nodes
            nodes.forEach(node => {
                const g = svg.append('g')
                    .attr('transform', `translate(${node.x}, ${node.y})`);

                if (node.type === 'decision') {
                    // Diamond shape
                    g.append('polygon')
                        .attr('points', '0,-35 100,0 0,35 -100,0')
                        .attr('fill', node.color)
                        .attr('fill-opacity', 0.2)
                        .attr('stroke', node.color)
                        .attr('stroke-width', 2);

                    g.append('text')
                        .attr('text-anchor', 'middle')
                        .attr('dy', '0.35em')
                        .attr('font-size', '1.25rem')
                        .attr('font-family', 'Montserrat, sans-serif')
                        .attr('fill', '#e5e7eb')
                        .text(node.text);
                } else {
                    // Rectangle for outcomes
                    const lines = node.text.split('\n');
                    const rectHeight = lines.length * 25 + 20;

                    g.append('rect')
                        .attr('x', -80)
                        .attr('y', -rectHeight/2)
                        .attr('width', 160)
                        .attr('height', rectHeight)
                        .attr('rx', 8)
                        .attr('fill', node.color)
                        .attr('fill-opacity', 0.3)
                        .attr('stroke', node.color)
                        .attr('stroke-width', 3);

                    lines.forEach((line, i) => {
                        g.append('text')
                            .attr('text-anchor', 'middle')
                            .attr('y', -rectHeight/2 + 25 + i * 25)
                            .attr('font-size', '1.25rem')
                            .attr('font-family', 'Montserrat, sans-serif')
                            .attr('font-weight', '600')
                            .attr('fill', node.color)
                            .text(line);
                    });
                }
            });
        }

        // ===== Visualization 3: Partial Sum Comparison (Slide 17) =====
        function drawPartialSums() {
            const container = document.getElementById('partial-sum-viz');
            if (!container || container.querySelector('svg')) return;

            const width = 800;
            const height = 450;
            const margin = { top: 30, right: 50, bottom: 50, left: 70 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = (height - margin.top - margin.bottom - 40) / 2;

            const svg = d3.select(container)
                .append('svg')
                .attr('viewBox', `0 0 ${width} ${height}`)
                .attr('preserveAspectRatio', 'xMidYMid meet');

            // Calculate partial sums
            const n = 50;
            const alternatingHarmonic = [];
            const harmonic = [];
            let sumAlt = 0;
            let sumHarm = 0;

            for (let i = 1; i <= n; i++) {
                sumAlt += Math.pow(-1, i + 1) / i;
                sumHarm += 1 / i;
                alternatingHarmonic.push({ n: i, sum: sumAlt });
                harmonic.push({ n: i, sum: sumHarm });
            }

            const ln2 = Math.log(2);

            // Top plot: Alternating Harmonic
            const g1 = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top})`);

            const xScale1 = d3.scaleLinear().domain([1, n]).range([0, plotWidth]);
            const yScale1 = d3.scaleLinear().domain([0.4, 1]).range([plotHeight, 0]);

            // Grid
            g1.append('g')
                .selectAll('line')
                .data([0.5, 0.6, 0.7, 0.8, 0.9])
                .enter()
                .append('line')
                .attr('x1', 0)
                .attr('x2', plotWidth)
                .attr('y1', d => yScale1(d))
                .attr('y2', d => yScale1(d))
                .attr('stroke', '#1c2640')
                .attr('stroke-width', 1);

            // Axes
            g1.append('g')
                .attr('transform', `translate(0, ${plotHeight})`)
                .call(d3.axisBottom(xScale1).ticks(10))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            g1.append('g')
                .call(d3.axisLeft(yScale1).ticks(5))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            // Limit line at ln(2)
            g1.append('line')
                .attr('x1', 0)
                .attr('x2', plotWidth)
                .attr('y1', yScale1(ln2))
                .attr('y2', yScale1(ln2))
                .attr('stroke', '#fbbf24')
                .attr('stroke-width', 2)
                .attr('stroke-dasharray', '8,4');

            g1.append('text')
                .attr('x', plotWidth + 5)
                .attr('y', yScale1(ln2) + 5)
                .attr('font-size', '1.25rem')
                .attr('fill', '#fbbf24')
                .text('ln(2)');

            // Data line
            const line1 = d3.line()
                .x(d => xScale1(d.n))
                .y(d => yScale1(d.sum));

            g1.append('path')
                .datum(alternatingHarmonic)
                .attr('fill', 'none')
                .attr('stroke', '#4f46e5')
                .attr('stroke-width', 2.5)
                .attr('d', line1);

            // Title
            g1.append('text')
                .attr('x', plotWidth / 2)
                .attr('y', -10)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.35rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#4f46e5')
                .attr('font-weight', '600')
                .text('\u03A3 (-1)\u207F/n  \u2192 Converges');

            // Bottom plot: Harmonic
            const g2 = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top + plotHeight + 60})`);

            const yScale2 = d3.scaleLinear().domain([0, 5]).range([plotHeight, 0]);

            // Grid
            g2.append('g')
                .selectAll('line')
                .data([1, 2, 3, 4])
                .enter()
                .append('line')
                .attr('x1', 0)
                .attr('x2', plotWidth)
                .attr('y1', d => yScale2(d))
                .attr('y2', d => yScale2(d))
                .attr('stroke', '#1c2640')
                .attr('stroke-width', 1);

            // Axes
            g2.append('g')
                .attr('transform', `translate(0, ${plotHeight})`)
                .call(d3.axisBottom(xScale1).ticks(10))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            g2.append('g')
                .call(d3.axisLeft(yScale2).ticks(5))
                .selectAll('text')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6');

            // Data line
            const line2 = d3.line()
                .x(d => xScale1(d.n))
                .y(d => yScale2(d.sum));

            g2.append('path')
                .datum(harmonic)
                .attr('fill', 'none')
                .attr('stroke', '#f97316')
                .attr('stroke-width', 2.5)
                .attr('d', line2);

            // Arrow indicating divergence
            g2.append('text')
                .attr('x', plotWidth - 20)
                .attr('y', yScale2(harmonic[n-1].sum) - 15)
                .attr('font-size', '1.5rem')
                .attr('fill', '#f97316')
                .text('\u2197');

            // Title
            g2.append('text')
                .attr('x', plotWidth / 2)
                .attr('y', -10)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.35rem')
                .attr('font-family', 'Montserrat, sans-serif')
                .attr('fill', '#f97316')
                .attr('font-weight', '600')
                .text('\u03A3 1/n  \u2192 Diverges');

            // X-axis label
            svg.append('text')
                .attr('x', width / 2)
                .attr('y', height - 5)
                .attr('text-anchor', 'middle')
                .attr('font-size', '1.25rem')
                .attr('fill', '#b8c4d6')
                .text('n (number of terms)');
        }

        // ===== Trigger Visualizations on Slide Entry =====
        const visualizationSlides = {
            7: drawHierarchy,
            10: drawFlowchart,
            17: drawPartialSums
        };

        let lastSlide = -1;

        function checkAndDrawVisualization() {
            if (!window.Presentation) return;

            const currentSlide = window.Presentation.getCurrentSlide();
            if (currentSlide !== lastSlide) {
                lastSlide = currentSlide;
                if (visualizationSlides[currentSlide]) {
                    setTimeout(visualizationSlides[currentSlide], 100);
                }
            }
        }

        // Check periodically for slide changes (polling pattern)
        setInterval(checkAndDrawVisualization, 200);

        // Also check on hash changes
        window.addEventListener('hashchange', () => {
            setTimeout(checkAndDrawVisualization, 100);
        });

        // Initial check after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(checkAndDrawVisualization, 200);
            });
        } else {
            setTimeout(checkAndDrawVisualization, 200);
        }
    </script>
</body>
</html>
